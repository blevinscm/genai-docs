
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://blevinscm.github.com/genai-docs/embeddings/Get-multimodal-embeddings/">
      
      
        <link rel="prev" href="../Get-batch-text-embeddings-predictions/">
      
      
        <link rel="next" href="../../model-reference/Function-calling-reference/">
      
      
      <link rel="icon" href="../../assets/google-cloud-vertex-ai.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Get Multimodal Embeddings - Vertex Generative AI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../js/chat-widget/chat-widget.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#get-multimodal-embeddings" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Vertex Generative AI" class="md-header__button md-logo" aria-label="Vertex Generative AI" data-md-component="logo">
      
  <img src="../../assets/google-cloud-vertex-ai.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vertex Generative AI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Get Multimodal Embeddings
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/blevinscm/genai-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Generative-AI-on-Vertex-AI-Cookbook/" class="md-tabs__link">
          
  
  
    
  
  Learn

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../agent-engine/Set-up-the-environment/" class="md-tabs__link">
          
  
  
    
  
  Build

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../models/Introduction-to-tuning/" class="md-tabs__link">
          
  
  
    
  
  Tune

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../deploy/Deploy-generative-AI-models/" class="md-tabs__link">
          
  
  
    
  
  Deploy

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../agent-engine/manage/Manage-deployed-agents/" class="md-tabs__link">
          
  
  
    
  
  Manage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../models/evaluation-overview/" class="md-tabs__link">
          
  
  
    
  
  Optimize

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vertex Generative AI" class="md-nav__button md-logo" aria-label="Vertex Generative AI" data-md-component="logo">
      
  <img src="../../assets/google-cloud-vertex-ai.png" alt="logo">

    </a>
    Vertex Generative AI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/blevinscm/genai-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Learn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Learn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Generative-AI-on-Vertex-AI-Cookbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vertex AI Generative AI Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Generative-AI-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Generative-AI-on-Vertex-AI-release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../supported-models_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Models Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-reference/gemini/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gemini Models Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../image/Imagen-on-Vertex-AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Imagen Models Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code/code-models-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Models Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligent-code-commenter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intelligent Code Commenter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-models/Use-Gemma-open-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Open Models (Gemma, Llama)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../partner-models/use-partner-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Partner Models (Claude, AI21)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learn/prompts/Introduction-to-prompting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Prompting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learn/prompts/Overview-of-prompting-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompting Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimodal/Design-multimodal-prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multimodal Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Choose-an-embeddings-task-type/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embeddings Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimodal/Introduction-to-function-calling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Function Calling Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grounding/Ground-responses-using-RAG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grounding Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-builder/Vertex-AI-Agent-Builder-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Builder Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/Vertex-AI-Agent-Engine-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Engine Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rag-engine/Vertex-AI-RAG-Engine-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RAG Engine Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../context-cache/Context-caching-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Caching Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extensions/Extensions-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extensions Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example-store/Example-Store-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example Store Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Generative-AI-and-data-governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Governance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Security-controls-for-Generative-AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security & Safety
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deprecations/Model-versions-and-lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deprecations & Lifecycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-help_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Help
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Build
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/Set-up-the-environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Set up Environment (Agent Engine)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/develop/Develop-a-LangChain-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Develop LangChain Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/develop/Develop-an-Agent-Development-Kit-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Develop ADK Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/use/Use-a-LangChain-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use LangChain Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/use/Use-a-LangGraph-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use LangGraph Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chat/Design-chat-prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Chat Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimodal/Text-generationbookmark_borderbookmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate Text with Gemini
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../image/Generate-images-using-text-prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate Images with Imagen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Generate-images-with-Gemini/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate Images with Gemini
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../video/generate-videos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate Video with Veo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Get-batch-text-embeddings-predictions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get Text Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Get Multimodal Embeddings
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Get Multimodal Embeddings
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#supported-models" class="md-nav__link">
    <span class="md-ellipsis">
      Supported models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best practices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-usage" class="md-nav__link">
    <span class="md-ellipsis">
      API usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-limits" class="md-nav__link">
    <span class="md-ellipsis">
      API limits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before-you-begin" class="md-nav__link">
    <span class="md-ellipsis">
      Before you begin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locations" class="md-nav__link">
    <span class="md-ellipsis">
      Locations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Error messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quota-exceeded-error" class="md-nav__link">
    <span class="md-ellipsis">
      Quota exceeded error
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specify-lower-dimension-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Specify lower-dimension embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#send-an-embedding-request-image-and-text" class="md-nav__link">
    <span class="md-ellipsis">
      Send an embedding request (image and text)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Send an embedding request (image and text)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-text-and-image-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Get text and image embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest_1" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl_1" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell_1" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-ai-sdk-for-python" class="md-nav__link">
    <span class="md-ellipsis">
      Vertex AI SDK for Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodejs" class="md-nav__link">
    <span class="md-ellipsis">
      Node.js
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      Java
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go_1" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#send-an-embedding-request-video-image-or-text" class="md-nav__link">
    <span class="md-ellipsis">
      Send an embedding request (video, image, or text)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Send an embedding request (video, image, or text)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#video-embedding-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Video embedding modes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#video-embeddings-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Video embeddings best practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-video-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Get video embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest_2" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl_2" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell_2" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-ai-sdk-for-python_1" class="md-nav__link">
    <span class="md-ellipsis">
      Vertex AI SDK for Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go_2" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-image-text-and-video-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Get image, text, and video embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest_3" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl_3" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell_3" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-ai-sdk-for-python_2" class="md-nav__link">
    <span class="md-ellipsis">
      Vertex AI SDK for Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go_3" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What's next
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-reference/Function-calling-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use Function Calling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grounding/Use-Google-Search-suggestions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use Grounding (Google Search)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grounding/Grounding-with-your-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use Grounding (Your Data)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rag-engine/Use-data-ingestion-with-Vertex-AI-RAG-Engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build with RAG Engine (Data Ingestion)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rag-engine/use-vertexai-vector-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build with RAG Engine (Vector Search)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Use-a-Weaviate-database-with-Vertex-AI-RAG-Engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build with RAG Engine (Weaviate)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../context-cache/Create-a-context-cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Context Cache
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extensions/Create-and-run-extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Extensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example-store/Retrieve-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use Example Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimodal/audio-understanding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multimodal Audio Understanding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimodal/Document-understanding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multimodal Document Understanding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimodal/Video-understanding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multimodal Video Understanding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prompt-gallery/samples/summarize_summarize_video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompt Gallery Samples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tune
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tune
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/Introduction-to-tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Model Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/About-supervised-fine-tuning-for-Gemini-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tune Gemini Models (Supervised)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/gemini-supervised-tuning-prepare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prepare Data for Gemini SFT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/tune_gemini/text_tune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tune Gemini for Text
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../image/Style-customization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tune Imagen Models (Style/Subject)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/Tune-function-calling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tune Function Calling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-garden/LoRA-and-QLoRA-recommendations-for-LLMs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoRA & QLoRA Recommendations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Fine-tune-RAG-transformations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fine-tune RAG Transformations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deploy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Deploy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/Deploy-generative-AI-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploy Generative AI Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/deploy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploy Agent (Agent Engine)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/Deployments-and-endpoints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployments and Endpoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-garden/Use-models-in-Model-Garden/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use Models from Model Garden
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Purchase-Provisioned-Throughput/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Purchase Provisioned Throughput
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Use-Provisioned-Throughput/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use Provisioned Throughput
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrate/Migrate-to-the-Gemini-API-from-Azure-OpenAI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migrate from Azure OpenAI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrate/openai/Using-OpenAI-libraries-with-Vertex-AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use OpenAI Libraries with Vertex AI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Manage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Manage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/manage/Manage-deployed-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage Deployed Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/manage/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/manage/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/sessions/Manage-sessions-using-direct-API-calls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage Agent Sessions (API)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/sessions/Manage-sessions-with-Agent-Development-Kit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage Agent Sessions (ADK)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../context-cache/Get-information-about-a-context-cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage Context Cache (Get/Delete)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Manage-your-RAG-knowledge-base-corpus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage RAG Corpus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learn/Model-monitoring-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Monitoring Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quotas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quotas & Limits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/troubleshooting/Troubleshoot-deploying-an-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshoot Agent Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-engine/troubleshooting/Troubleshoot-developing-an-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshoot Agent Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimize
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Optimize
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/evaluation-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Evaluation Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/Gen-AI-evaluation-service-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gen AI Evaluation Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/Run-AutoSxS-pipeline-to-perform-pairwise-model-based-evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Run AutoSxS (Pairwise Evaluation)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/Evaluate-Gen-AI-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluate Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learn/prompts/Optimize-promptsbookmark_borderbookmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimize Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Retrieval-and-ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RAG Retrieval and Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-reference/Vertex-AI-Model-Optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vertex AI Model Optimizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../provisioned-throughput/Calculate-Provisioned-Throughput-requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calculate Provisioned Throughput
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-reference/count-tokens/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Count Tokens
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../context-cache/Context-caching-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Caching Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#supported-models" class="md-nav__link">
    <span class="md-ellipsis">
      Supported models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best practices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-usage" class="md-nav__link">
    <span class="md-ellipsis">
      API usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-limits" class="md-nav__link">
    <span class="md-ellipsis">
      API limits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before-you-begin" class="md-nav__link">
    <span class="md-ellipsis">
      Before you begin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locations" class="md-nav__link">
    <span class="md-ellipsis">
      Locations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Error messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quota-exceeded-error" class="md-nav__link">
    <span class="md-ellipsis">
      Quota exceeded error
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specify-lower-dimension-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Specify lower-dimension embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#send-an-embedding-request-image-and-text" class="md-nav__link">
    <span class="md-ellipsis">
      Send an embedding request (image and text)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Send an embedding request (image and text)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-text-and-image-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Get text and image embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest_1" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl_1" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell_1" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-ai-sdk-for-python" class="md-nav__link">
    <span class="md-ellipsis">
      Vertex AI SDK for Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodejs" class="md-nav__link">
    <span class="md-ellipsis">
      Node.js
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      Java
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go_1" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#send-an-embedding-request-video-image-or-text" class="md-nav__link">
    <span class="md-ellipsis">
      Send an embedding request (video, image, or text)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Send an embedding request (video, image, or text)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#video-embedding-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Video embedding modes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#video-embeddings-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Video embeddings best practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-video-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Get video embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest_2" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl_2" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell_2" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-ai-sdk-for-python_1" class="md-nav__link">
    <span class="md-ellipsis">
      Vertex AI SDK for Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go_2" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-image-text-and-video-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Get image, text, and video embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest_3" class="md-nav__link">
    <span class="md-ellipsis">
      REST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#curl_3" class="md-nav__link">
    <span class="md-ellipsis">
      curl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell_3" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-ai-sdk-for-python_2" class="md-nav__link">
    <span class="md-ellipsis">
      Vertex AI SDK for Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go_3" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What's next
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/blevinscm/genai-docs/edit/main/docs/embeddings/Get-multimodal-embeddings.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="get-multimodal-embeddings">Get multimodal embeddings<a class="headerlink" href="#get-multimodal-embeddings" title="Permanent link">&para;</a></h1>
<p>To see an example of multimodal embeddings,
run the "Intro to multimodal embeddings" Jupyter notebook in one of the following
environments:</p>
<p><a href="https://colab.research.google.com/github/GoogleCloudPlatform/generative-ai/blob/main/embeddings/intro_multimodal_embeddings.ipynb">Open
in Colab</a>
|
<a href="https://console.cloud.google.com/vertex-ai/colab/import/https%3A%2F%2Fraw.githubusercontent.com%2FGoogleCloudPlatform%2Fgenerative-ai%2Fmain%2Fembeddings%2Fintro_multimodal_embeddings.ipynb">Open
in Colab Enterprise</a>
|
<a href="https://console.cloud.google.com/vertex-ai/workbench/deploy-notebook?download_url=https%3A%2F%2Fraw.githubusercontent.com%2FGoogleCloudPlatform%2Fgenerative-ai%2Fmain%2Fembeddings%2Fintro_multimodal_embeddings.ipynb">Open
in Vertex AI Workbench user-managed notebooks</a>
|
<a href="https://github.com/GoogleCloudPlatform/generative-ai/blob/main/embeddings/intro_multimodal_embeddings.ipynb">View on GitHub</a></p>
<p>The multimodal embeddings model generates 1408-dimension vectors* based on the
input you provide, which can include a combination of image, text, and video
data. The embedding vectors can then be used for subsequent tasks like image
classification or video content moderation.</p>
<p>The image embedding vector and text embedding vector are in the same semantic
space with the same dimensionality. Consequently, these vectors can be used
interchangeably for use cases like searching image by text, or searching video
by image.</p>
<p>For text-only embedding use cases, we recommend using the Vertex AI
text-embeddings API instead. For example, the text-embeddings API might be
better for text-based semantic search, clustering, long-form document analysis,
and other text retrieval or question-answering use cases. For more information,
see <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-text-embeddings">Get text embeddings</a>.</p>
<h2 id="supported-models">Supported models<a class="headerlink" href="#supported-models" title="Permanent link">&para;</a></h2>
<p>You can get multimodal embeddings by using the following model:</p>
<ul>
<li><code>multimodalembedding</code></li>
</ul>
<h2 id="best-practices">Best practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<p>Consider the following input aspects when using the multimodal embeddings model:</p>
<ul>
<li><strong>Text in images</strong> - The model can distinguish text in images, similar to
 optical character recognition (OCR). If you need to distinguish between a
 description of the image content and the text within an image, consider
 using prompt engineering to specify your target content.
 For example: instead of just "cat", specify "picture of a cat" or
 "the text 'cat'", depending on your use case.</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>the text</strong> 'cat'</td>
<td></td>
</tr>
<tr>
<td><strong>picture of</strong> a cat</td>
<td><em>Image credit: <a href="https://unsplash.com/photos/gKXKBY-C-Dk">Manja Vitolic</a> on <a href="https://unsplash.com/">Unsplash</a>.</em></td>
</tr>
<tr>
<td>- <strong>Embedding similarities</strong> - The dot product of embeddings isn't a</td>
<td></td>
</tr>
<tr>
<td>calibrated probability. The dot product is a similarity metric and might have</td>
<td></td>
</tr>
<tr>
<td>different score distributions for different use cases. Consequently, avoid</td>
<td></td>
</tr>
<tr>
<td>using a fixed value threshold to measure quality. Instead, use ranking</td>
<td></td>
</tr>
<tr>
<td>approaches for retrieval, or use sigmoid for classification.</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="api-usage">API usage<a class="headerlink" href="#api-usage" title="Permanent link">&para;</a></h2>
<h3 id="api-limits">API limits<a class="headerlink" href="#api-limits" title="Permanent link">&para;</a></h3>
<p>The following limits apply when you use the <code>multimodalembedding</code> model for
text and image embeddings:</p>
<table>
<thead>
<tr>
<th>Limit</th>
<th>Value and description</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><strong>Text and image data</strong></td>
</tr>
<tr>
<td>Maximum number of API requests per minute per project</td>
<td>120</td>
</tr>
<tr>
<td>Maximum text length</td>
<td>32 tokens (~32 words) The maximum text length is 32 tokens (approximately 32 words). If the input exceeds 32 tokens, the model internally shortens the input to this length.</td>
</tr>
<tr>
<td>Language</td>
<td>English</td>
</tr>
<tr>
<td>Image formats</td>
<td>BMP, GIF, JPG, PNG</td>
</tr>
<tr>
<td>Image size</td>
<td>Base64-encoded images: 20 MB (when transcoded to PNG) Cloud Storage images: 20MB (original file format) The maximum image size accepted is 20 MB. To avoid increased network latency, use smaller images. Additionally, the model resizes images to 512 x 512 pixel resolution. Consequently, you don't need to provide higher resolution images.</td>
</tr>
<tr>
<td></td>
<td><strong>Video data</strong></td>
</tr>
<tr>
<td>Audio supported</td>
<td>N/A - The model doesn't consider audio content when generating video embeddings</td>
</tr>
<tr>
<td>Video formats</td>
<td>AVI, FLV, MKV, MOV, MP4, MPEG, MPG, WEBM, and WMV</td>
</tr>
<tr>
<td>Maximum video length (Cloud Storage)</td>
<td>No limit. However, only 2 minutes of content can be analyzed at a time.</td>
</tr>
</tbody>
</table>
<h3 id="before-you-begin">Before you begin<a class="headerlink" href="#before-you-begin" title="Permanent link">&para;</a></h3>
<ul>
<li>Sign in to your Google Cloud account. If you're new to
 Google Cloud, <a href="https://console.cloud.google.com/freetrial">create an account</a> to evaluate how our products perform in
 real-world scenarios. New customers also get $300 in free credits to
 run, test, and deploy workloads.</li>
<li>In the Google Cloud console, on the project selector page,
 select or create a Google Cloud project.</li>
</ul>
<p><a href="https://console.cloud.google.com/projectselector2/home/dashboard">Go to project selector</a>
- <a href="https://cloud.google.com/billing/docs/how-to/verify-billing-enabled#confirm_billing_is_enabled_on_a_project">Make sure that billing is enabled for your Google Cloud project</a>.
- Enable the Vertex AI API.</p>
<p><a href="https://console.cloud.google.com/flows/enableapi?apiid=aiplatform.googleapis.com">Enable the API</a>
- In the Google Cloud console, on the project selector page,
 select or create a Google Cloud project.</p>
<p><a href="https://console.cloud.google.com/projectselector2/home/dashboard">Go to project selector</a>
- <a href="https://cloud.google.com/billing/docs/how-to/verify-billing-enabled#confirm_billing_is_enabled_on_a_project">Make sure that billing is enabled for your Google Cloud project</a>.
- Enable the Vertex AI API.</p>
<p><a href="https://console.cloud.google.com/flows/enableapi?apiid=aiplatform.googleapis.com">Enable the API</a></p>
<p>Certain tasks in Vertex AI require that you use additional
Google Cloud products besides Vertex AI. For example, in most
cases, you must use Cloud Storage and Artifact Registry when you
create a custom training pipeline. You might need to perform additional setup
tasks to use other Google Cloud products.
1. Set up authentication for your environment.</p>
<p>Select the tab for how you plan to use the samples on this page:</p>
<p>### Java</p>
<p>To use the Java samples on this page in a local
 development environment, install and initialize the gcloud CLI, and
 then set up Application Default Credentials with your user credentials.</p>
<ol>
<li><a href="https://cloud.google.com/sdk/docs/install">Install</a> the Google Cloud CLI.</li>
<li>If you're using an external identity provider (IdP), you must first
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">sign in to the gcloud CLI with your federated identity</a>.</li>
<li>To <a href="https://cloud.google.com/sdk/docs/initializing">initialize</a> the gcloud CLI, run the following command:</li>
</ol>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">gcloud</span> <span class="n">init</span>
</span></code></pre></div>
 4. Update and install <code>gcloud</code> components:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">update</span> 
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">install</span> <span class="n">beta</span>
</span></code></pre></div>
 5. If you're using a local shell, then create local authentication credentials for your user
 account:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">gcloud</span> <span class="n">auth</span> <span class="n">application</span><span class="o">-</span><span class="n">default</span> <span class="n">login</span>
</span></code></pre></div>
<p>You don't need to do this if you're using Cloud Shell.</p>
<p>If an authentication error is returned, and you are using an external identity provider
 (IdP), confirm that you have
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">signed in to the gcloud CLI with your federated identity</a>.</p>
<p>For more information, see
 <a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up ADC for a local development environment</a>
 in the Google Cloud authentication documentation.</p>
<p>### Node.js</p>
<p>To use the Node.js samples on this page in a local
 development environment, install and initialize the gcloud CLI, and
 then set up Application Default Credentials with your user credentials.</p>
<ol>
<li><a href="https://cloud.google.com/sdk/docs/install">Install</a> the Google Cloud CLI.</li>
<li>If you're using an external identity provider (IdP), you must first
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">sign in to the gcloud CLI with your federated identity</a>.</li>
<li>To <a href="https://cloud.google.com/sdk/docs/initializing">initialize</a> the gcloud CLI, run the following command:</li>
</ol>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">gcloud</span> <span class="n">init</span>
</span></code></pre></div>
 4. Update and install <code>gcloud</code> components:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">update</span> 
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">install</span> <span class="n">beta</span>
</span></code></pre></div>
 5. If you're using a local shell, then create local authentication credentials for your user
 account:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">gcloud</span> <span class="n">auth</span> <span class="n">application</span><span class="o">-</span><span class="n">default</span> <span class="n">login</span>
</span></code></pre></div>
<p>You don't need to do this if you're using Cloud Shell.</p>
<p>If an authentication error is returned, and you are using an external identity provider
 (IdP), confirm that you have
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">signed in to the gcloud CLI with your federated identity</a>.</p>
<p>For more information, see
 <a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up ADC for a local development environment</a>
 in the Google Cloud authentication documentation.</p>
<p>### Python</p>
<p>To use the Python samples on this page in a local
 development environment, install and initialize the gcloud CLI, and
 then set up Application Default Credentials with your user credentials.</p>
<ol>
<li><a href="https://cloud.google.com/sdk/docs/install">Install</a> the Google Cloud CLI.</li>
<li>If you're using an external identity provider (IdP), you must first
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">sign in to the gcloud CLI with your federated identity</a>.</li>
<li>To <a href="https://cloud.google.com/sdk/docs/initializing">initialize</a> the gcloud CLI, run the following command:</li>
</ol>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">gcloud</span> <span class="n">init</span>
</span></code></pre></div>
 4. Update and install <code>gcloud</code> components:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">update</span> 
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">install</span> <span class="n">beta</span>
</span></code></pre></div>
 5. If you're using a local shell, then create local authentication credentials for your user
 account:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">gcloud</span> <span class="n">auth</span> <span class="n">application</span><span class="o">-</span><span class="n">default</span> <span class="n">login</span>
</span></code></pre></div>
<p>You don't need to do this if you're using Cloud Shell.</p>
<p>If an authentication error is returned, and you are using an external identity provider
 (IdP), confirm that you have
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">signed in to the gcloud CLI with your federated identity</a>.</p>
<p>For more information, see
 <a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up ADC for a local development environment</a>
 in the Google Cloud authentication documentation.</p>
<p>### REST</p>
<p>To use the REST API samples on this page in a local development environment,
 you use the credentials you provide to the gcloud CLI.</p>
<ol>
<li><a href="https://cloud.google.com/sdk/docs/install">Install</a> the Google Cloud CLI.</li>
<li>If you're using an external identity provider (IdP), you must first
 <a href="https://cloud.google.com/iam/docs/workforce-log-in-gcloud">sign in to the gcloud CLI with your federated identity</a>.</li>
<li>To <a href="https://cloud.google.com/sdk/docs/initializing">initialize</a> the gcloud CLI, run the following command:</li>
</ol>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">gcloud</span> <span class="n">init</span>
</span></code></pre></div>
 4. Update and install <code>gcloud</code> components:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">update</span> 
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">gcloud</span> <span class="n">components</span> <span class="n">install</span> <span class="n">beta</span>
</span></code></pre></div>
<p>For more information, see
 <a href="https://cloud.google.com/docs/authentication/rest">Authenticate for using REST</a>
 in the Google Cloud authentication documentation.
2. To use the Python SDK, follow instructions at
 <a href="https://cloud.google.com/vertex-ai/docs/start/install-sdk">Install the Vertex AI SDK for Python</a>.
 For more information, see the
 <a href="https://cloud.google.com/python/docs/reference/aiplatform/latest">Vertex AI SDK for Python API reference documentation</a>.
3. Optional. Review <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">pricing</a> for this
 feature. Pricing for embeddings depends on the type of data you send
 (such as image or text), and also depends on the mode you use for certain
 data types (such as Video Plus, Video Standard, or Video Essential).</p>
<h3 id="locations">Locations<a class="headerlink" href="#locations" title="Permanent link">&para;</a></h3>
<p>A location is a <a href="/about/locations">region</a> you can specify in a request to
control where data is stored at rest. For a list of available regions, see <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/learn/locations-genai">Generative AI on Vertex AI locations</a>.</p>
<h3 id="error-messages">Error messages<a class="headerlink" href="#error-messages" title="Permanent link">&para;</a></h3>
<h4 id="quota-exceeded-error">Quota exceeded error<a class="headerlink" href="#quota-exceeded-error" title="Permanent link">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">google</span><span class="o">.</span><span class="n">api_core</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ResourceExhausted</span><span class="p">:</span> <span class="mi">429</span> <span class="n">Quota</span> <span class="n">exceeded</span> <span class="k">for</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">aiplatform</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">online_prediction_requests_per_base_model</span> <span class="k">with</span> <span class="n">base</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">model</span><span class="p">:</span> <span class="n">multimodalembedding</span><span class="o">.</span> <span class="n">Please</span> <span class="n">submit</span> <span class="n">a</span> <span class="n">quota</span> <span class="n">increase</span> <span class="n">request</span><span class="o">.</span>
</span></code></pre></div>
<p>If this is the first time you receive this error, use the Google Cloud console
to <a href="https://cloud.google.com/docs/quotas/view-manage#requesting_higher_quota">request a quota increase</a> for your project. Use the
following filters before requesting your increase:</p>
<ul>
<li><code>Service ID: aiplatform.googleapis.com</code></li>
<li><code>metric: aiplatform.googleapis.com/online_prediction_requests_per_base_model</code></li>
<li><code>base_model:multimodalembedding</code></li>
</ul>
<p><a href="https://console.cloud.google.com/iam-admin/quotas?service=aiplatform.googleapis.com&amp;metric=aiplatform.googleapis.com/online_prediction_requests_per_base_model&amp;base_model=multimodalembedding">Go to
Quotas</a></p>
<p>If you have already sent a quota increase request, wait before sending another
request. If you need to further increase the quota, repeat the quota increase
request with your justification for a sustained quota request.</p>
<h3 id="specify-lower-dimension-embeddings">Specify lower-dimension embeddings<a class="headerlink" href="#specify-lower-dimension-embeddings" title="Permanent link">&para;</a></h3>
<p>By default an embedding request returns a 1408 float vector for a data type. You
can also specify lower-dimension embeddings (128, 256, or 512 float vectors) for
text and image data. This option lets you optimize for latency and storage or
quality based on how you plan to use the embeddings. Lower-dimension embeddings
provide decreased storage needs and lower latency for subsequent embedding tasks
(like search or recommendation), while higher-dimension embeddings offer greater
accuracy for the same tasks.</p>
<h3 id="rest">REST<a class="headerlink" href="#rest" title="Permanent link">&para;</a></h3>
<p>Low-dimension can be accessed by adding the <code>parameters.dimension</code> field.
The parameter accepts one of the following values: <code>128</code>, <code>256</code>, <code>512</code> or
<code>1408</code>. The response includes the embedding of that dimension.</p>
<p>Before using any of the request data,
make the following replacements:</p>
<ul>
<li>LOCATION: Your project's region. For example,
 <code>us-central1</code>, <code>europe-west2</code>, or <code>asia-northeast3</code>. For a list
 of available regions, see
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/learn/locations-genai">Generative AI on Vertex AI locations</a>.</li>
<li>PROJECT_ID: Your Google Cloud <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifiers">project ID</a>.</li>
<li>IMAGE_URI: The Cloud Storage URI of the target image to get embeddings for.
 For example, <code>gs://my-bucket/embeddings/supermarket-img.png</code>.</li>
</ul>
<p>You can also provide the image as a
 base64-encoded byte string:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="s2">&quot;bytesBase64Encoded&quot;</span><span class="p">:</span> <span class="s2">&quot;B64_ENCODED_IMAGE&quot;</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="p">}</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
- TEXT: The target text to get embeddings for. For example,
 <code>a cat</code>.
- EMBEDDING_DIMENSION: The number of embedding dimensions. Lower values offer decreased
 latency when using these embeddings for subsequent tasks, while higher values offer better
 accuracy. Available values: <code>128</code>,
 <code>256</code>, <code>512</code>, and <code>1408</code> (default).</p>
<p>HTTP method and URL:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">LOCATION</span><span class="o">-</span><span class="n">aiplatform</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">PROJECT_ID</span><span class="o">/</span><span class="n">locations</span><span class="o">/</span><span class="n">LOCATION</span><span class="o">/</span><span class="n">publishers</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">multimodalembedding</span><span class="o">@</span><span class="mi">001</span><span class="p">:</span><span class="n">predict</span>
</span></code></pre></div>
<p>Request JSON body:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a> <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a> <span class="p">{</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;IMAGE_URI&quot;</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a> <span class="p">},</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXT&quot;</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a> <span class="p">}</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a> <span class="p">],</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a> <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a> <span class="s2">&quot;dimension&quot;</span><span class="p">:</span> <span class="n">EMBEDDING_DIMENSION</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a> <span class="p">}</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>To send your request, choose one of these options:</p>
<h4 id="curl">curl<a class="headerlink" href="#curl" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
, or by using <a href="https://cloud.google.com/shell/docs">Cloud Shell</a>,
which automatically logs you into the <code>gcloud</code> CLI
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \ 
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Authorization: Bearer $(gcloud auth print-access-token)&quot;</span> \ 
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json; charset=utf-8&quot;</span> \ 
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a> <span class="o">-</span><span class="n">d</span> <span class="nd">@request</span><span class="o">.</span><span class="n">json</span> \ 
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span>
</span></code></pre></div>
<h4 id="powershell">PowerShell<a class="headerlink" href="#powershell" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="err">$</span><span class="n">cred</span> <span class="o">=</span> <span class="n">gcloud</span> <span class="n">auth</span> <span class="nb">print</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">token</span> 
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="err">$</span><span class="n">headers</span> <span class="o">=</span> <span class="o">@</span><span class="p">{</span> <span class="s2">&quot;Authorization&quot;</span> <span class="o">=</span> <span class="s2">&quot;Bearer $cred&quot;</span> <span class="p">}</span> 
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">Invoke</span><span class="o">-</span><span class="n">WebRequest</span> <span class="err">`</span> 
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a> <span class="o">-</span><span class="n">Method</span> <span class="n">POST</span> <span class="err">`</span> 
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a> <span class="o">-</span><span class="n">Headers</span> <span class="err">$</span><span class="n">headers</span> <span class="err">`</span> 
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a> <span class="o">-</span><span class="n">ContentType</span><span class="p">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span> <span class="err">`</span> 
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a> <span class="o">-</span><span class="n">InFile</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="err">`</span> 
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a> <span class="o">-</span><span class="n">Uri</span> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span> <span class="o">|</span> <span class="n">Select</span><span class="o">-</span><span class="n">Object</span> <span class="o">-</span><span class="n">Expand</span> <span class="n">Content</span>
</span></code></pre></div>
<p>The embedding the model returns a float vector of the dimension you specify. The following sample
responses are shortened for space.</p>
<p><strong>128 dimensions:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">{</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a> <span class="p">{</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a> <span class="s2">&quot;imageEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a> <span class="mf">0.0279239565</span><span class="p">,</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a> <span class="p">[</span><span class="o">..</span><span class="mf">.128</span> <span class="n">dimension</span> <span class="n">vector</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a> <span class="mf">0.00403284049</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a> <span class="p">],</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a> <span class="s2">&quot;textEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a> <span class="mf">0.202921599</span><span class="p">,</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a> <span class="p">[</span><span class="o">..</span><span class="mf">.128</span> <span class="n">dimension</span> <span class="n">vector</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a> <span class="o">-</span><span class="mf">0.0365431122</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a> <span class="p">]</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a> <span class="p">}</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a> <span class="p">],</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>256 dimensions:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a> <span class="p">{</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a> <span class="s2">&quot;imageEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a> <span class="mf">0.248620048</span><span class="p">,</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a> <span class="p">[</span><span class="o">..</span><span class="mf">.256</span> <span class="n">dimension</span> <span class="n">vector</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a> <span class="o">-</span><span class="mf">0.0646447465</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a> <span class="p">],</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a> <span class="s2">&quot;textEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a> <span class="mf">0.0757875815</span><span class="p">,</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a> <span class="p">[</span><span class="o">..</span><span class="mf">.256</span> <span class="n">dimension</span> <span class="n">vector</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a> <span class="o">-</span><span class="mf">0.02749932</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a> <span class="p">]</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a> <span class="p">}</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a> <span class="p">],</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>512 dimensions:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="p">{</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a> <span class="p">{</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a> <span class="s2">&quot;imageEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a> <span class="o">-</span><span class="mf">0.0523675755</span><span class="p">,</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a> <span class="p">[</span><span class="o">..</span><span class="mf">.512</span> <span class="n">dimension</span> <span class="n">vector</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a> <span class="o">-</span><span class="mf">0.0444030389</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a> <span class="p">],</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a> <span class="s2">&quot;textEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a> <span class="o">-</span><span class="mf">0.0592851527</span><span class="p">,</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a> <span class="p">[</span><span class="o">..</span><span class="mf">.512</span> <span class="n">dimension</span> <span class="n">vector</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a> <span class="mf">0.0350437127</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a> <span class="p">]</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a> <span class="p">}</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a> <span class="p">],</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="python">Python<a class="headerlink" href="#python" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">vertexai</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">vertexai.vision_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">MultiModalEmbeddingModel</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c1"># TODO(developer): Update &amp; uncomment line below</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="c1"># PROJECT_ID = &quot;your-project-id&quot;</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">vertexai</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;us-central1&quot;</span><span class="p">)</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c1"># TODO(developer): Try different dimenions: 128, 256, 512, 1408</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="n">embedding_dimension</span> <span class="o">=</span> <span class="mi">128</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MultiModalEmbeddingModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;multimodalembedding@001&quot;</span><span class="p">)</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai/llm/prompts/landmark1.png&quot;</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="p">)</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="n">embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">(</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a> <span class="n">contextual_text</span><span class="o">=</span><span class="s2">&quot;Colosseum&quot;</span><span class="p">,</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a> <span class="n">dimension</span><span class="o">=</span><span class="n">embedding_dimension</span><span class="p">,</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="p">)</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image Embedding: </span><span class="si">{</span><span class="n">embeddings</span><span class="o">.</span><span class="n">image_embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Text Embedding: </span><span class="si">{</span><span class="n">embeddings</span><span class="o">.</span><span class="n">text_embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="c1"># Example response:</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="c1"># Image Embedding: [0.0622573346, -0.0406507477, 0.0260440577, ...]</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="c1"># Text Embedding: [0.27469793, -0.146258667, 0.0222803634, ...]</span>
</span></code></pre></div>
<h3 id="go">Go<a class="headerlink" href="#go" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a> <span class="s2">&quot;context&quot;</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a> <span class="s2">&quot;encoding/json&quot;</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a> <span class="s2">&quot;fmt&quot;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a> <span class="s2">&quot;io&quot;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a> <span class="n">aiplatform</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1&quot;</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a> <span class="n">aiplatformpb</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1/aiplatformpb&quot;</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a> <span class="s2">&quot;google.golang.org/api/option&quot;</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a> <span class="s2">&quot;google.golang.org/protobuf/encoding/protojson&quot;</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a> <span class="s2">&quot;google.golang.org/protobuf/types/known/structpb&quot;</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="p">)</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="o">//</span> <span class="n">generateWithLowerDimension</span> <span class="n">shows</span> <span class="n">how</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">lower</span><span class="o">-</span><span class="n">dimensional</span> <span class="n">embeddings</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">and</span> <span class="n">image</span> <span class="n">inputs</span><span class="o">.</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="n">func</span> <span class="n">generateWithLowerDimension</span><span class="p">(</span><span class="n">w</span> <span class="n">io</span><span class="o">.</span><span class="n">Writer</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span> <span class="n">string</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a> <span class="o">//</span> <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a> <span class="n">ctx</span> <span class="o">:=</span> <span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a> <span class="n">apiEndpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-aiplatform.googleapis.com:443&quot;</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a> <span class="n">client</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">aiplatform</span><span class="o">.</span><span class="n">NewPredictionClient</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">WithEndpoint</span><span class="p">(</span><span class="n">apiEndpoint</span><span class="p">))</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct API client: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a> <span class="p">}</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a> <span class="n">defer</span> <span class="n">client</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a> <span class="n">model</span> <span class="o">:=</span> <span class="s2">&quot;multimodalembedding@001&quot;</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a> <span class="n">endpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;projects/</span><span class="si">%s</span><span class="s2">/locations/</span><span class="si">%s</span><span class="s2">/publishers/google/models/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a> <span class="o">//</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">to</span> <span class="n">the</span> <span class="n">model</span><span class="s1">&#39;s prediction call. For schema, see:</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#request_body</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a> <span class="n">instance</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">structpb</span><span class="o">.</span><span class="n">NewValue</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a> <span class="o">//</span> <span class="n">Image</span> <span class="nb">input</span> <span class="n">can</span> <span class="n">be</span> <span class="n">provided</span> <span class="n">either</span> <span class="k">as</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">Cloud</span> <span class="n">Storage</span> <span class="n">URI</span> <span class="ow">or</span> <span class="k">as</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a> <span class="o">//</span> <span class="n">base64</span><span class="o">-</span><span class="n">encoded</span> <span class="nb">bytes</span> <span class="n">using</span> <span class="n">the</span> <span class="s2">&quot;bytesBase64Encoded&quot;</span> <span class="n">field</span><span class="o">.</span>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai/llm/prompts/landmark1.png&quot;</span><span class="p">,</span>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a> <span class="p">},</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Colosseum&quot;</span><span class="p">,</span>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a> <span class="p">})</span>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct request payload: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-21-40"><a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a> <span class="p">}</span>
</span><span id="__span-21-41"><a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a>
</span><span id="__span-21-42"><a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a> <span class="o">//</span> <span class="n">TODO</span><span class="p">(</span><span class="n">developer</span><span class="p">):</span> <span class="n">Try</span> <span class="n">different</span> <span class="n">dimenions</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1408</span>
</span><span id="__span-21-43"><a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a> <span class="n">outputDimensionality</span> <span class="o">:=</span> <span class="mi">128</span>
</span><span id="__span-21-44"><a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a> <span class="n">params</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">structpb</span><span class="o">.</span><span class="n">NewValue</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-21-45"><a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a> <span class="s2">&quot;dimension&quot;</span><span class="p">:</span> <span class="n">outputDimensionality</span><span class="p">,</span>
</span><span id="__span-21-46"><a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a> <span class="p">})</span>
</span><span id="__span-21-47"><a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-21-48"><a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct request params: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-21-49"><a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a> <span class="p">}</span>
</span><span id="__span-21-50"><a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a>
</span><span id="__span-21-51"><a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a> <span class="n">req</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">aiplatformpb</span><span class="o">.</span><span class="n">PredictRequest</span><span class="p">{</span>
</span><span id="__span-21-52"><a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a> <span class="n">Endpoint</span><span class="p">:</span> <span class="n">endpoint</span><span class="p">,</span>
</span><span id="__span-21-53"><a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a> <span class="o">//</span> <span class="n">The</span> <span class="n">model</span> <span class="n">supports</span> <span class="n">only</span> <span class="mi">1</span> <span class="n">instance</span> <span class="n">per</span> <span class="n">request</span><span class="o">.</span>
</span><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a> <span class="n">Instances</span><span class="p">:</span> <span class="p">[]</span><span class="o">*</span><span class="n">structpb</span><span class="o">.</span><span class="n">Value</span><span class="p">{</span><span class="n">instance</span><span class="p">},</span>
</span><span id="__span-21-55"><a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a> <span class="n">Parameters</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
</span><span id="__span-21-56"><a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a> <span class="p">}</span>
</span><span id="__span-21-57"><a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a>
</span><span id="__span-21-58"><a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a> <span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span>
</span><span id="__span-21-59"><a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-21-60"><a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to generate embeddings: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-21-61"><a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a> <span class="p">}</span>
</span><span id="__span-21-62"><a id="__codelineno-21-62" name="__codelineno-21-62" href="#__codelineno-21-62"></a>
</span><span id="__span-21-63"><a id="__codelineno-21-63" name="__codelineno-21-63" href="#__codelineno-21-63"></a> <span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">protojson</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">GetPredictions</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-21-64"><a id="__codelineno-21-64" name="__codelineno-21-64" href="#__codelineno-21-64"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-21-65"><a id="__codelineno-21-65" name="__codelineno-21-65" href="#__codelineno-21-65"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to convert protobuf value to JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-21-66"><a id="__codelineno-21-66" name="__codelineno-21-66" href="#__codelineno-21-66"></a> <span class="p">}</span>
</span><span id="__span-21-67"><a id="__codelineno-21-67" name="__codelineno-21-67" href="#__codelineno-21-67"></a> <span class="o">//</span> <span class="n">For</span> <span class="n">response</span> <span class="n">schema</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span>
</span><span id="__span-21-68"><a id="__codelineno-21-68" name="__codelineno-21-68" href="#__codelineno-21-68"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#response-body</span>
</span><span id="__span-21-69"><a id="__codelineno-21-69" name="__codelineno-21-69" href="#__codelineno-21-69"></a> <span class="n">var</span> <span class="n">instanceEmbeddings</span> <span class="n">struct</span> <span class="p">{</span>
</span><span id="__span-21-70"><a id="__codelineno-21-70" name="__codelineno-21-70" href="#__codelineno-21-70"></a> <span class="n">ImageEmbeddings</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;imageEmbedding&quot;</span><span class="err">`</span>
</span><span id="__span-21-71"><a id="__codelineno-21-71" name="__codelineno-21-71" href="#__codelineno-21-71"></a> <span class="n">TextEmbeddings</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;textEmbedding&quot;</span><span class="err">`</span>
</span><span id="__span-21-72"><a id="__codelineno-21-72" name="__codelineno-21-72" href="#__codelineno-21-72"></a> <span class="p">}</span>
</span><span id="__span-21-73"><a id="__codelineno-21-73" name="__codelineno-21-73" href="#__codelineno-21-73"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">instanceEmbeddings</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-21-74"><a id="__codelineno-21-74" name="__codelineno-21-74" href="#__codelineno-21-74"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to unmarshal JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-21-75"><a id="__codelineno-21-75" name="__codelineno-21-75" href="#__codelineno-21-75"></a> <span class="p">}</span>
</span><span id="__span-21-76"><a id="__codelineno-21-76" name="__codelineno-21-76" href="#__codelineno-21-76"></a>
</span><span id="__span-21-77"><a id="__codelineno-21-77" name="__codelineno-21-77" href="#__codelineno-21-77"></a> <span class="n">imageEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">ImageEmbeddings</span>
</span><span id="__span-21-78"><a id="__codelineno-21-78" name="__codelineno-21-78" href="#__codelineno-21-78"></a> <span class="n">textEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">TextEmbeddings</span>
</span><span id="__span-21-79"><a id="__codelineno-21-79" name="__codelineno-21-79" href="#__codelineno-21-79"></a>
</span><span id="__span-21-80"><a id="__codelineno-21-80" name="__codelineno-21-80" href="#__codelineno-21-80"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Text embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">textEmbedding</span><span class="p">),</span> <span class="n">textEmbedding</span><span class="p">)</span>
</span><span id="__span-21-81"><a id="__codelineno-21-81" name="__codelineno-21-81" href="#__codelineno-21-81"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Image embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">imageEmbedding</span><span class="p">),</span> <span class="n">imageEmbedding</span><span class="p">)</span>
</span><span id="__span-21-82"><a id="__codelineno-21-82" name="__codelineno-21-82" href="#__codelineno-21-82"></a> <span class="o">//</span> <span class="n">Example</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-21-83"><a id="__codelineno-21-83" name="__codelineno-21-83" href="#__codelineno-21-83"></a> <span class="o">//</span> <span class="n">Text</span> <span class="n">Embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.27469793</span> <span class="o">-</span><span class="mf">0.14625867</span> <span class="mf">0.022280363</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-21-84"><a id="__codelineno-21-84" name="__codelineno-21-84" href="#__codelineno-21-84"></a> <span class="o">//</span> <span class="n">Image</span> <span class="n">Embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.06225733</span> <span class="o">-</span><span class="mf">0.040650766</span> <span class="mf">0.02604402</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-21-85"><a id="__codelineno-21-85" name="__codelineno-21-85" href="#__codelineno-21-85"></a>
</span><span id="__span-21-86"><a id="__codelineno-21-86" name="__codelineno-21-86" href="#__codelineno-21-86"></a> <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-21-87"><a id="__codelineno-21-87" name="__codelineno-21-87" href="#__codelineno-21-87"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="send-an-embedding-request-image-and-text">Send an embedding request (image and text)<a class="headerlink" href="#send-an-embedding-request-image-and-text" title="Permanent link">&para;</a></h2>
<p><strong>Note:</strong>
For text-only embedding use cases, we recommend using the Vertex AI
text-embeddings API instead. For example, the text-embeddings API might be
better for text-based semantic search, clustering, long-form document analysis,
and other text retrieval or question-answering use cases. For more information,
see <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-text-embeddings">Get text embeddings</a>.</p>
<p>Use the following code samples to send an embedding request with image and text
data. The samples show how to send a request with both data types, but you can
also use the service with an individual data type.</p>
<h3 id="get-text-and-image-embeddings">Get text and image embeddings<a class="headerlink" href="#get-text-and-image-embeddings" title="Permanent link">&para;</a></h3>
<h3 id="rest_1">REST<a class="headerlink" href="#rest_1" title="Permanent link">&para;</a></h3>
<p>For more information about <code>multimodalembedding</code> model requests, see the
<a href="https://cloud.google.com/vertex-ai/generative-ai/docs/model-reference/multimodal-embeddings"><code>multimodalembedding</code> model API reference</a>.</p>
<p>Before using any of the request data,
make the following replacements:</p>
<ul>
<li>LOCATION: Your project's region. For example,
 <code>us-central1</code>, <code>europe-west2</code>, or <code>asia-northeast3</code>. For a list
 of available regions, see
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/learn/locations-genai">Generative AI on Vertex AI locations</a>.</li>
<li>PROJECT_ID: Your Google Cloud <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifiers">project ID</a>.</li>
<li>TEXT: The target text to get embeddings for. For example,
 <code>a cat</code>.</li>
<li>B64_ENCODED_IMG: The target image to get embeddings for. The image must be
 specified as a <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/image/base64-encode">base64-encoded</a> byte string.</li>
</ul>
<p>HTTP method and URL:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">LOCATION</span><span class="o">-</span><span class="n">aiplatform</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">PROJECT_ID</span><span class="o">/</span><span class="n">locations</span><span class="o">/</span><span class="n">LOCATION</span><span class="o">/</span><span class="n">publishers</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">multimodalembedding</span><span class="o">@</span><span class="mi">001</span><span class="p">:</span><span class="n">predict</span>
</span></code></pre></div>
<p>Request JSON body:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a> <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a> <span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a> <span class="s2">&quot;bytesBase64Encoded&quot;</span><span class="p">:</span> <span class="s2">&quot;B64_ENCODED_IMG&quot;</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a> <span class="p">}</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a> <span class="p">}</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a> <span class="p">]</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="p">}</span>
</span></code></pre></div>
<p>To send your request, choose one of these options:</p>
<h4 id="curl_1">curl<a class="headerlink" href="#curl_1" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
, or by using <a href="https://cloud.google.com/shell/docs">Cloud Shell</a>,
which automatically logs you into the <code>gcloud</code> CLI
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \ 
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Authorization: Bearer $(gcloud auth print-access-token)&quot;</span> \ 
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json; charset=utf-8&quot;</span> \ 
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a> <span class="o">-</span><span class="n">d</span> <span class="nd">@request</span><span class="o">.</span><span class="n">json</span> \ 
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span>
</span></code></pre></div>
<h4 id="powershell_1">PowerShell<a class="headerlink" href="#powershell_1" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="err">$</span><span class="n">cred</span> <span class="o">=</span> <span class="n">gcloud</span> <span class="n">auth</span> <span class="nb">print</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">token</span> 
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="err">$</span><span class="n">headers</span> <span class="o">=</span> <span class="o">@</span><span class="p">{</span> <span class="s2">&quot;Authorization&quot;</span> <span class="o">=</span> <span class="s2">&quot;Bearer $cred&quot;</span> <span class="p">}</span> 
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">Invoke</span><span class="o">-</span><span class="n">WebRequest</span> <span class="err">`</span> 
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a> <span class="o">-</span><span class="n">Method</span> <span class="n">POST</span> <span class="err">`</span> 
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a> <span class="o">-</span><span class="n">Headers</span> <span class="err">$</span><span class="n">headers</span> <span class="err">`</span> 
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a> <span class="o">-</span><span class="n">ContentType</span><span class="p">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span> <span class="err">`</span> 
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a> <span class="o">-</span><span class="n">InFile</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="err">`</span> 
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a> <span class="o">-</span><span class="n">Uri</span> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span> <span class="o">|</span> <span class="n">Select</span><span class="o">-</span><span class="n">Object</span> <span class="o">-</span><span class="n">Expand</span> <span class="n">Content</span>
</span></code></pre></div>
<p>The embedding the model returns is a 1408 float vector. The following sample response is shortened
for space.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a> <span class="p">{</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a> <span class="s2">&quot;textEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a> <span class="mf">0.010477379</span><span class="p">,</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a> <span class="o">-</span><span class="mf">0.00399621</span><span class="p">,</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a> <span class="mf">0.00576670747</span><span class="p">,</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a> <span class="o">-</span><span class="mf">0.00823613815</span><span class="p">,</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a> <span class="o">-</span><span class="mf">0.0169572588</span><span class="p">,</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a> <span class="o">-</span><span class="mf">0.00472954148</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a> <span class="p">],</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a> <span class="s2">&quot;imageEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a> <span class="mf">0.00262696808</span><span class="p">,</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a> <span class="o">-</span><span class="mf">0.00198890246</span><span class="p">,</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a> <span class="mf">0.0152047109</span><span class="p">,</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a> <span class="o">-</span><span class="mf">0.0103145819</span><span class="p">,</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a> <span class="mf">0.0324628279</span><span class="p">,</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a> <span class="mf">0.0284924973</span><span class="p">,</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a> <span class="mf">0.011650892</span><span class="p">,</span>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a> <span class="o">-</span><span class="mf">0.00452344026</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a> <span class="p">]</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a> <span class="p">}</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a> <span class="p">],</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="vertex-ai-sdk-for-python">Vertex AI SDK for Python<a class="headerlink" href="#vertex-ai-sdk-for-python" title="Permanent link">&para;</a></h3>
<p>To learn how to install or update the Vertex AI SDK for Python, see <a href="https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk">Install the Vertex AI SDK for Python</a>.
For more information, see the
<a href="https://cloud.google.com/python/docs/reference/aiplatform/latest">Vertex AI SDK for Python API reference documentation</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">vertexai</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">vertexai.vision_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">MultiModalEmbeddingModel</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1"># TODO(developer): Update &amp; uncomment line below</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="c1"># PROJECT_ID = &quot;your-project-id&quot;</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="n">vertexai</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;us-central1&quot;</span><span class="p">)</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MultiModalEmbeddingModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;multimodalembedding@001&quot;</span><span class="p">)</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai/llm/prompts/landmark1.png&quot;</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="p">)</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="n">embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">(</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a> <span class="n">contextual_text</span><span class="o">=</span><span class="s2">&quot;Colosseum&quot;</span><span class="p">,</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a> <span class="n">dimension</span><span class="o">=</span><span class="mi">1408</span><span class="p">,</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="p">)</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image Embedding: </span><span class="si">{</span><span class="n">embeddings</span><span class="o">.</span><span class="n">image_embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Text Embedding: </span><span class="si">{</span><span class="n">embeddings</span><span class="o">.</span><span class="n">text_embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="c1"># Example response:</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="c1"># Image Embedding: [-0.0123147098, 0.0727171078, ...]</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="c1"># Text Embedding: [0.00230263756, 0.0278981831, ...]</span>
</span></code></pre></div>
<h3 id="nodejs">Node.js<a class="headerlink" href="#nodejs" title="Permanent link">&para;</a></h3>
<p>Before trying this sample, follow the Node.js setup instructions in the
<a href="https://cloud.google.com/vertex-ai/docs/start/client-libraries">Vertex AI quickstart using
client libraries</a>.
For more information, see the
<a href="/nodejs/docs/reference/aiplatform/latest">Vertex AI Node.js API
reference documentation</a>.</p>
<p>To authenticate to Vertex AI, set up Application Default Credentials.
For more information, see
<a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up authentication for a local development environment</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="o">/**</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a> <span class="o">*</span> <span class="n">TODO</span><span class="p">(</span><span class="n">developer</span><span class="p">):</span> <span class="n">Uncomment</span> <span class="n">these</span> <span class="n">variables</span> <span class="n">before</span> <span class="n">running</span> <span class="n">the</span> <span class="n">sample</span><span class="o">.</span>\
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a> <span class="o">*</span> <span class="p">(</span><span class="n">Not</span> <span class="n">necessary</span> <span class="k">if</span> <span class="n">passing</span> <span class="n">values</span> <span class="k">as</span> <span class="n">arguments</span><span class="p">)</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a> <span class="o">*/</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="o">//</span> <span class="n">const</span> <span class="n">project</span> <span class="o">=</span> <span class="s1">&#39;YOUR_PROJECT_ID&#39;</span><span class="p">;</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="o">//</span> <span class="n">const</span> <span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;YOUR_PROJECT_LOCATION&#39;</span><span class="p">;</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="o">//</span> <span class="n">const</span> <span class="n">bastImagePath</span> <span class="o">=</span> <span class="s2">&quot;YOUR_BASED_IMAGE_PATH&quot;</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="o">//</span> <span class="n">const</span> <span class="n">textPrompt</span> <span class="o">=</span> <span class="s1">&#39;YOUR_TEXT_PROMPT&#39;</span><span class="p">;</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="n">const</span> <span class="n">aiplatform</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;@google-cloud/aiplatform&#39;</span><span class="p">);</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="o">//</span> <span class="n">Imports</span> <span class="n">the</span> <span class="n">Google</span> <span class="n">Cloud</span> <span class="n">Prediction</span> <span class="n">service</span> <span class="n">client</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="n">const</span> <span class="p">{</span><span class="n">PredictionServiceClient</span><span class="p">}</span> <span class="o">=</span> <span class="n">aiplatform</span><span class="o">.</span><span class="n">v1</span><span class="p">;</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="o">//</span> <span class="n">Import</span> <span class="n">the</span> <span class="n">helper</span> <span class="n">module</span> <span class="k">for</span> <span class="n">converting</span> <span class="n">arbitrary</span> <span class="n">protobuf</span><span class="o">.</span><span class="n">Value</span> <span class="n">objects</span><span class="o">.</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="n">const</span> <span class="p">{</span><span class="n">helpers</span><span class="p">}</span> <span class="o">=</span> <span class="n">aiplatform</span><span class="p">;</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="o">//</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">location</span> <span class="n">of</span> <span class="n">the</span> <span class="n">api</span> <span class="n">endpoint</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="n">const</span> <span class="n">clientOptions</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a> <span class="n">apiEndpoint</span><span class="p">:</span> <span class="s1">&#39;us-central1-aiplatform.googleapis.com&#39;</span><span class="p">,</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="p">};</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="n">const</span> <span class="n">publisher</span> <span class="o">=</span> <span class="s1">&#39;google&#39;</span><span class="p">;</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="n">const</span> <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;multimodalembedding@001&#39;</span><span class="p">;</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="o">//</span> <span class="n">Instantiates</span> <span class="n">a</span> <span class="n">client</span>
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="n">const</span> <span class="n">predictionServiceClient</span> <span class="o">=</span> <span class="n">new</span> <span class="n">PredictionServiceClient</span><span class="p">(</span><span class="n">clientOptions</span><span class="p">);</span>
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="k">async</span> <span class="n">function</span> <span class="n">predictImageFromImageAndText</span><span class="p">()</span> <span class="p">{</span>
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a> <span class="o">//</span> <span class="n">Configure</span> <span class="n">the</span> <span class="n">parent</span> <span class="n">resource</span>
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a> <span class="n">const</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="err">`</span><span class="n">projects</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">project</span><span class="p">}</span><span class="o">/</span><span class="n">locations</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">location</span><span class="p">}</span><span class="o">/</span><span class="n">publishers</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">publisher</span><span class="p">}</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">model</span><span class="p">}</span><span class="err">`</span><span class="p">;</span>
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a> <span class="n">const</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
</span><span id="__span-28-32"><a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a> <span class="n">const</span> <span class="n">imageFile</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">readFileSync</span><span class="p">(</span><span class="n">baseImagePath</span><span class="p">);</span>
</span><span id="__span-28-33"><a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>
</span><span id="__span-28-34"><a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a> <span class="o">//</span> <span class="n">Convert</span> <span class="n">the</span> <span class="n">image</span> <span class="n">data</span> <span class="n">to</span> <span class="n">a</span> <span class="n">Buffer</span> <span class="ow">and</span> <span class="n">base64</span> <span class="n">encode</span> <span class="n">it</span><span class="o">.</span>
</span><span id="__span-28-35"><a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a> <span class="n">const</span> <span class="n">encodedImage</span> <span class="o">=</span> <span class="n">Buffer</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">imageFile</span><span class="p">)</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">);</span>
</span><span id="__span-28-36"><a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>
</span><span id="__span-28-37"><a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a> <span class="n">const</span> <span class="n">prompt</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-28-38"><a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a> <span class="n">text</span><span class="p">:</span> <span class="n">textPrompt</span><span class="p">,</span>
</span><span id="__span-28-39"><a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a> <span class="n">image</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-28-40"><a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a> <span class="n">bytesBase64Encoded</span><span class="p">:</span> <span class="n">encodedImage</span><span class="p">,</span>
</span><span id="__span-28-41"><a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a> <span class="p">},</span>
</span><span id="__span-28-42"><a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a> <span class="p">};</span>
</span><span id="__span-28-43"><a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a> <span class="n">const</span> <span class="n">instanceValue</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">toValue</span><span class="p">(</span><span class="n">prompt</span><span class="p">);</span>
</span><span id="__span-28-44"><a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a> <span class="n">const</span> <span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">instanceValue</span><span class="p">];</span>
</span><span id="__span-28-45"><a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a>
</span><span id="__span-28-46"><a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a> <span class="n">const</span> <span class="n">parameter</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-28-47"><a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a> <span class="n">sampleCount</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-28-48"><a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a> <span class="p">};</span>
</span><span id="__span-28-49"><a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a> <span class="n">const</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">toValue</span><span class="p">(</span><span class="n">parameter</span><span class="p">);</span>
</span><span id="__span-28-50"><a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a>
</span><span id="__span-28-51"><a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a> <span class="n">const</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-28-52"><a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a> <span class="n">endpoint</span><span class="p">,</span>
</span><span id="__span-28-53"><a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a> <span class="n">instances</span><span class="p">,</span>
</span><span id="__span-28-54"><a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a> <span class="n">parameters</span><span class="p">,</span>
</span><span id="__span-28-55"><a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a> <span class="p">};</span>
</span><span id="__span-28-56"><a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a>
</span><span id="__span-28-57"><a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a> <span class="o">//</span> <span class="n">Predict</span> <span class="n">request</span>
</span><span id="__span-28-58"><a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a> <span class="n">const</span> <span class="p">[</span><span class="n">response</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="n">predictionServiceClient</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span><span id="__span-28-59"><a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Get image embedding response&#39;</span><span class="p">);</span>
</span><span id="__span-28-60"><a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a> <span class="n">const</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">predictions</span><span class="p">;</span>
</span><span id="__span-28-61"><a id="__codelineno-28-61" name="__codelineno-28-61" href="#__codelineno-28-61"></a> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Predictions :&#39;</span><span class="p">);</span>
</span><span id="__span-28-62"><a id="__codelineno-28-62" name="__codelineno-28-62" href="#__codelineno-28-62"></a> <span class="k">for</span> <span class="p">(</span><span class="n">const</span> <span class="n">prediction</span> <span class="n">of</span> <span class="n">predictions</span><span class="p">)</span> <span class="p">{</span>
</span><span id="__span-28-63"><a id="__codelineno-28-63" name="__codelineno-28-63" href="#__codelineno-28-63"></a> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="err">`</span>\<span class="n">t</span>\<span class="n">tPrediction</span> <span class="p">:</span> <span class="err">$</span><span class="p">{</span><span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">prediction</span><span class="p">)}</span><span class="err">`</span><span class="p">);</span>
</span><span id="__span-28-64"><a id="__codelineno-28-64" name="__codelineno-28-64" href="#__codelineno-28-64"></a> <span class="p">}</span>
</span><span id="__span-28-65"><a id="__codelineno-28-65" name="__codelineno-28-65" href="#__codelineno-28-65"></a><span class="p">}</span>
</span><span id="__span-28-66"><a id="__codelineno-28-66" name="__codelineno-28-66" href="#__codelineno-28-66"></a>
</span><span id="__span-28-67"><a id="__codelineno-28-67" name="__codelineno-28-67" href="#__codelineno-28-67"></a><span class="k">await</span> <span class="n">predictImageFromImageAndText</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="java">Java<a class="headerlink" href="#java" title="Permanent link">&para;</a></h3>
<p>Before trying this sample, follow the Java setup instructions in the
<a href="https://cloud.google.com/vertex-ai/docs/start/client-libraries">Vertex AI quickstart using
client libraries</a>.
For more information, see the
<a href="/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1">Vertex AI Java API
reference documentation</a>.</p>
<p>To authenticate to Vertex AI, set up Application Default Credentials.
For more information, see
<a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up authentication for a local development environment</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.cloud.aiplatform.v1beta1.EndpointName</span><span class="p">;</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.cloud.aiplatform.v1beta1.PredictResponse</span><span class="p">;</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.cloud.aiplatform.v1beta1.PredictionServiceClient</span><span class="p">;</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.cloud.aiplatform.v1beta1.PredictionServiceSettings</span><span class="p">;</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.gson.Gson</span><span class="p">;</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.gson.JsonObject</span><span class="p">;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.protobuf.InvalidProtocolBufferException</span><span class="p">;</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.protobuf.Value</span><span class="p">;</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.google.protobuf.util.JsonFormat</span><span class="p">;</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.charset.StandardCharsets</span><span class="p">;</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Files</span><span class="p">;</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Paths</span><span class="p">;</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Base64</span><span class="p">;</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.HashMap</span><span class="p">;</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">PredictImageFromImageAndTextSample</span> <span class="p">{</span>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a> <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a> <span class="o">//</span> <span class="n">TODO</span><span class="p">(</span><span class="n">developer</span><span class="p">):</span> <span class="n">Replace</span> <span class="n">this</span> <span class="n">variable</span> <span class="n">before</span> <span class="n">running</span> <span class="n">the</span> <span class="n">sample</span><span class="o">.</span>
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a> <span class="n">String</span> <span class="n">project</span> <span class="o">=</span> <span class="s2">&quot;YOUR_PROJECT_ID&quot;</span><span class="p">;</span>
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a> <span class="n">String</span> <span class="n">textPrompt</span> <span class="o">=</span> <span class="s2">&quot;YOUR_TEXT_PROMPT&quot;</span><span class="p">;</span>
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a> <span class="n">String</span> <span class="n">baseImagePath</span> <span class="o">=</span> <span class="s2">&quot;YOUR_BASE_IMAGE_PATH&quot;</span><span class="p">;</span>
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a> <span class="o">//</span> <span class="n">Learn</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">text</span> <span class="n">prompts</span> <span class="n">to</span> <span class="n">update</span> <span class="n">an</span> <span class="n">image</span><span class="p">:</span>
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">edit</span><span class="o">-</span><span class="n">images</span>
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a> <span class="n">parameters</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;sampleCount&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a>
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a> <span class="n">String</span> <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span><span class="p">;</span>
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a> <span class="n">String</span> <span class="n">publisher</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span><span class="p">;</span>
</span><span id="__span-29-35"><a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a> <span class="n">String</span> <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;multimodalembedding@001&quot;</span><span class="p">;</span>
</span><span id="__span-29-36"><a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>
</span><span id="__span-29-37"><a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a> <span class="n">predictImageFromImageAndText</span><span class="p">(</span>
</span><span id="__span-29-38"><a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a> <span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">publisher</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">textPrompt</span><span class="p">,</span> <span class="n">baseImagePath</span><span class="p">,</span> <span class="n">parameters</span><span class="p">);</span>
</span><span id="__span-29-39"><a id="__codelineno-29-39" name="__codelineno-29-39" href="#__codelineno-29-39"></a> <span class="p">}</span>
</span><span id="__span-29-40"><a id="__codelineno-29-40" name="__codelineno-29-40" href="#__codelineno-29-40"></a>
</span><span id="__span-29-41"><a id="__codelineno-29-41" name="__codelineno-29-41" href="#__codelineno-29-41"></a> <span class="o">//</span> <span class="n">Update</span> <span class="n">images</span> <span class="n">using</span> <span class="n">text</span> <span class="n">prompts</span>
</span><span id="__span-29-42"><a id="__codelineno-29-42" name="__codelineno-29-42" href="#__codelineno-29-42"></a> <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">predictImageFromImageAndText</span><span class="p">(</span>
</span><span id="__span-29-43"><a id="__codelineno-29-43" name="__codelineno-29-43" href="#__codelineno-29-43"></a> <span class="n">String</span> <span class="n">project</span><span class="p">,</span>
</span><span id="__span-29-44"><a id="__codelineno-29-44" name="__codelineno-29-44" href="#__codelineno-29-44"></a> <span class="n">String</span> <span class="n">location</span><span class="p">,</span>
</span><span id="__span-29-45"><a id="__codelineno-29-45" name="__codelineno-29-45" href="#__codelineno-29-45"></a> <span class="n">String</span> <span class="n">publisher</span><span class="p">,</span>
</span><span id="__span-29-46"><a id="__codelineno-29-46" name="__codelineno-29-46" href="#__codelineno-29-46"></a> <span class="n">String</span> <span class="n">model</span><span class="p">,</span>
</span><span id="__span-29-47"><a id="__codelineno-29-47" name="__codelineno-29-47" href="#__codelineno-29-47"></a> <span class="n">String</span> <span class="n">textPrompt</span><span class="p">,</span>
</span><span id="__span-29-48"><a id="__codelineno-29-48" name="__codelineno-29-48" href="#__codelineno-29-48"></a> <span class="n">String</span> <span class="n">baseImagePath</span><span class="p">,</span>
</span><span id="__span-29-49"><a id="__codelineno-29-49" name="__codelineno-29-49" href="#__codelineno-29-49"></a> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">parameters</span><span class="p">)</span>
</span><span id="__span-29-50"><a id="__codelineno-29-50" name="__codelineno-29-50" href="#__codelineno-29-50"></a> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>
</span><span id="__span-29-51"><a id="__codelineno-29-51" name="__codelineno-29-51" href="#__codelineno-29-51"></a> <span class="n">final</span> <span class="n">String</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-aiplatform.googleapis.com:443&quot;</span><span class="p">,</span> <span class="n">location</span><span class="p">);</span>
</span><span id="__span-29-52"><a id="__codelineno-29-52" name="__codelineno-29-52" href="#__codelineno-29-52"></a> <span class="n">final</span> <span class="n">PredictionServiceSettings</span> <span class="n">predictionServiceSettings</span> <span class="o">=</span>
</span><span id="__span-29-53"><a id="__codelineno-29-53" name="__codelineno-29-53" href="#__codelineno-29-53"></a> <span class="n">PredictionServiceSettings</span><span class="o">.</span><span class="n">newBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">setEndpoint</span><span class="p">(</span><span class="n">endpoint</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">();</span>
</span><span id="__span-29-54"><a id="__codelineno-29-54" name="__codelineno-29-54" href="#__codelineno-29-54"></a>
</span><span id="__span-29-55"><a id="__codelineno-29-55" name="__codelineno-29-55" href="#__codelineno-29-55"></a> <span class="o">//</span> <span class="n">Initialize</span> <span class="n">client</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">send</span> <span class="n">requests</span><span class="o">.</span> <span class="n">This</span> <span class="n">client</span> <span class="n">only</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">created</span>
</span><span id="__span-29-56"><a id="__codelineno-29-56" name="__codelineno-29-56" href="#__codelineno-29-56"></a> <span class="o">//</span> <span class="n">once</span><span class="p">,</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">be</span> <span class="n">reused</span> <span class="k">for</span> <span class="n">multiple</span> <span class="n">requests</span><span class="o">.</span>
</span><span id="__span-29-57"><a id="__codelineno-29-57" name="__codelineno-29-57" href="#__codelineno-29-57"></a> <span class="k">try</span> <span class="p">(</span><span class="n">PredictionServiceClient</span> <span class="n">predictionServiceClient</span> <span class="o">=</span>
</span><span id="__span-29-58"><a id="__codelineno-29-58" name="__codelineno-29-58" href="#__codelineno-29-58"></a> <span class="n">PredictionServiceClient</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">predictionServiceSettings</span><span class="p">))</span> <span class="p">{</span>
</span><span id="__span-29-59"><a id="__codelineno-29-59" name="__codelineno-29-59" href="#__codelineno-29-59"></a> <span class="n">final</span> <span class="n">EndpointName</span> <span class="n">endpointName</span> <span class="o">=</span>
</span><span id="__span-29-60"><a id="__codelineno-29-60" name="__codelineno-29-60" href="#__codelineno-29-60"></a> <span class="n">EndpointName</span><span class="o">.</span><span class="n">ofProjectLocationPublisherModelName</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">publisher</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</span><span id="__span-29-61"><a id="__codelineno-29-61" name="__codelineno-29-61" href="#__codelineno-29-61"></a>
</span><span id="__span-29-62"><a id="__codelineno-29-62" name="__codelineno-29-62" href="#__codelineno-29-62"></a> <span class="o">//</span> <span class="n">Convert</span> <span class="n">the</span> <span class="n">image</span> <span class="n">to</span> <span class="n">Base64</span>
</span><span id="__span-29-63"><a id="__codelineno-29-63" name="__codelineno-29-63" href="#__codelineno-29-63"></a> <span class="n">byte</span><span class="p">[]</span> <span class="n">imageData</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="n">getEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">Files</span><span class="o">.</span><span class="n">readAllBytes</span><span class="p">(</span><span class="n">Paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">baseImagePath</span><span class="p">)));</span>
</span><span id="__span-29-64"><a id="__codelineno-29-64" name="__codelineno-29-64" href="#__codelineno-29-64"></a> <span class="n">String</span> <span class="n">encodedImage</span> <span class="o">=</span> <span class="n">new</span> <span class="n">String</span><span class="p">(</span><span class="n">imageData</span><span class="p">,</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="n">UTF_8</span><span class="p">);</span>
</span><span id="__span-29-65"><a id="__codelineno-29-65" name="__codelineno-29-65" href="#__codelineno-29-65"></a>
</span><span id="__span-29-66"><a id="__codelineno-29-66" name="__codelineno-29-66" href="#__codelineno-29-66"></a> <span class="n">JsonObject</span> <span class="n">jsonInstance</span> <span class="o">=</span> <span class="n">new</span> <span class="n">JsonObject</span><span class="p">();</span>
</span><span id="__span-29-67"><a id="__codelineno-29-67" name="__codelineno-29-67" href="#__codelineno-29-67"></a> <span class="n">jsonInstance</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">textPrompt</span><span class="p">);</span>
</span><span id="__span-29-68"><a id="__codelineno-29-68" name="__codelineno-29-68" href="#__codelineno-29-68"></a> <span class="n">JsonObject</span> <span class="n">jsonImage</span> <span class="o">=</span> <span class="n">new</span> <span class="n">JsonObject</span><span class="p">();</span>
</span><span id="__span-29-69"><a id="__codelineno-29-69" name="__codelineno-29-69" href="#__codelineno-29-69"></a> <span class="n">jsonImage</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;bytesBase64Encoded&quot;</span><span class="p">,</span> <span class="n">encodedImage</span><span class="p">);</span>
</span><span id="__span-29-70"><a id="__codelineno-29-70" name="__codelineno-29-70" href="#__codelineno-29-70"></a> <span class="n">jsonInstance</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="n">jsonImage</span><span class="p">);</span>
</span><span id="__span-29-71"><a id="__codelineno-29-71" name="__codelineno-29-71" href="#__codelineno-29-71"></a>
</span><span id="__span-29-72"><a id="__codelineno-29-72" name="__codelineno-29-72" href="#__codelineno-29-72"></a> <span class="n">Value</span> <span class="n">instanceValue</span> <span class="o">=</span> <span class="n">stringToValue</span><span class="p">(</span><span class="n">jsonInstance</span><span class="o">.</span><span class="n">toString</span><span class="p">());</span>
</span><span id="__span-29-73"><a id="__codelineno-29-73" name="__codelineno-29-73" href="#__codelineno-29-73"></a> <span class="n">List</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">&gt;</span> <span class="n">instances</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-29-74"><a id="__codelineno-29-74" name="__codelineno-29-74" href="#__codelineno-29-74"></a> <span class="n">instances</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">instanceValue</span><span class="p">);</span>
</span><span id="__span-29-75"><a id="__codelineno-29-75" name="__codelineno-29-75" href="#__codelineno-29-75"></a>
</span><span id="__span-29-76"><a id="__codelineno-29-76" name="__codelineno-29-76" href="#__codelineno-29-76"></a> <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Gson</span><span class="p">();</span>
</span><span id="__span-29-77"><a id="__codelineno-29-77" name="__codelineno-29-77" href="#__codelineno-29-77"></a> <span class="n">String</span> <span class="n">gsonString</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="n">toJson</span><span class="p">(</span><span class="n">parameters</span><span class="p">);</span>
</span><span id="__span-29-78"><a id="__codelineno-29-78" name="__codelineno-29-78" href="#__codelineno-29-78"></a> <span class="n">Value</span> <span class="n">parameterValue</span> <span class="o">=</span> <span class="n">stringToValue</span><span class="p">(</span><span class="n">gsonString</span><span class="p">);</span>
</span><span id="__span-29-79"><a id="__codelineno-29-79" name="__codelineno-29-79" href="#__codelineno-29-79"></a>
</span><span id="__span-29-80"><a id="__codelineno-29-80" name="__codelineno-29-80" href="#__codelineno-29-80"></a> <span class="n">PredictResponse</span> <span class="n">predictResponse</span> <span class="o">=</span>
</span><span id="__span-29-81"><a id="__codelineno-29-81" name="__codelineno-29-81" href="#__codelineno-29-81"></a> <span class="n">predictionServiceClient</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">endpointName</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span> <span class="n">parameterValue</span><span class="p">);</span>
</span><span id="__span-29-82"><a id="__codelineno-29-82" name="__codelineno-29-82" href="#__codelineno-29-82"></a> <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;Predict Response&quot;</span><span class="p">);</span>
</span><span id="__span-29-83"><a id="__codelineno-29-83" name="__codelineno-29-83" href="#__codelineno-29-83"></a> <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">predictResponse</span><span class="p">);</span>
</span><span id="__span-29-84"><a id="__codelineno-29-84" name="__codelineno-29-84" href="#__codelineno-29-84"></a> <span class="k">for</span> <span class="p">(</span><span class="n">Value</span> <span class="n">prediction</span> <span class="p">:</span> <span class="n">predictResponse</span><span class="o">.</span><span class="n">getPredictionsList</span><span class="p">())</span> <span class="p">{</span>
</span><span id="__span-29-85"><a id="__codelineno-29-85" name="__codelineno-29-85" href="#__codelineno-29-85"></a> <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Prediction: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prediction</span><span class="p">);</span>
</span><span id="__span-29-86"><a id="__codelineno-29-86" name="__codelineno-29-86" href="#__codelineno-29-86"></a> <span class="p">}</span>
</span><span id="__span-29-87"><a id="__codelineno-29-87" name="__codelineno-29-87" href="#__codelineno-29-87"></a> <span class="p">}</span>
</span><span id="__span-29-88"><a id="__codelineno-29-88" name="__codelineno-29-88" href="#__codelineno-29-88"></a> <span class="p">}</span>
</span><span id="__span-29-89"><a id="__codelineno-29-89" name="__codelineno-29-89" href="#__codelineno-29-89"></a>
</span><span id="__span-29-90"><a id="__codelineno-29-90" name="__codelineno-29-90" href="#__codelineno-29-90"></a> <span class="o">//</span> <span class="n">Convert</span> <span class="n">a</span> <span class="n">Json</span> <span class="n">string</span> <span class="n">to</span> <span class="n">a</span> <span class="n">protobuf</span><span class="o">.</span><span class="n">Value</span>
</span><span id="__span-29-91"><a id="__codelineno-29-91" name="__codelineno-29-91" href="#__codelineno-29-91"></a> <span class="n">static</span> <span class="n">Value</span> <span class="n">stringToValue</span><span class="p">(</span><span class="n">String</span> <span class="n">value</span><span class="p">)</span> <span class="n">throws</span> <span class="n">InvalidProtocolBufferException</span> <span class="p">{</span>
</span><span id="__span-29-92"><a id="__codelineno-29-92" name="__codelineno-29-92" href="#__codelineno-29-92"></a> <span class="n">Value</span><span class="o">.</span><span class="n">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">Value</span><span class="o">.</span><span class="n">newBuilder</span><span class="p">();</span>
</span><span id="__span-29-93"><a id="__codelineno-29-93" name="__codelineno-29-93" href="#__codelineno-29-93"></a> <span class="n">JsonFormat</span><span class="o">.</span><span class="n">parser</span><span class="p">()</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">builder</span><span class="p">);</span>
</span><span id="__span-29-94"><a id="__codelineno-29-94" name="__codelineno-29-94" href="#__codelineno-29-94"></a> <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">();</span>
</span><span id="__span-29-95"><a id="__codelineno-29-95" name="__codelineno-29-95" href="#__codelineno-29-95"></a> <span class="p">}</span>
</span><span id="__span-29-96"><a id="__codelineno-29-96" name="__codelineno-29-96" href="#__codelineno-29-96"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="go_1">Go<a class="headerlink" href="#go_1" title="Permanent link">&para;</a></h3>
<p>Before trying this sample, follow the Go setup instructions in the
<a href="https://cloud.google.com/vertex-ai/docs/start/client-libraries">Vertex AI quickstart using
client libraries</a>.
For more information, see the
<a href="/go/docs/reference/cloud.google.com/go/aiplatform/latest/apiv1">Vertex AI Go API
reference documentation</a>.</p>
<p>To authenticate to Vertex AI, set up Application Default Credentials.
For more information, see
<a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up authentication for a local development environment</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a> <span class="s2">&quot;context&quot;</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a> <span class="s2">&quot;encoding/json&quot;</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a> <span class="s2">&quot;fmt&quot;</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a> <span class="s2">&quot;io&quot;</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a> <span class="n">aiplatform</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1&quot;</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a> <span class="n">aiplatformpb</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1/aiplatformpb&quot;</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a> <span class="s2">&quot;google.golang.org/api/option&quot;</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a> <span class="s2">&quot;google.golang.org/protobuf/encoding/protojson&quot;</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a> <span class="s2">&quot;google.golang.org/protobuf/types/known/structpb&quot;</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="p">)</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="o">//</span> <span class="n">generateForTextAndImage</span> <span class="n">shows</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="n">multimodal</span> <span class="n">model</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">embeddings</span> <span class="k">for</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="o">//</span> <span class="n">text</span> <span class="ow">and</span> <span class="n">image</span> <span class="n">inputs</span><span class="o">.</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="n">func</span> <span class="n">generateForTextAndImage</span><span class="p">(</span><span class="n">w</span> <span class="n">io</span><span class="o">.</span><span class="n">Writer</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span> <span class="n">string</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a> <span class="o">//</span> <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a> <span class="n">ctx</span> <span class="o">:=</span> <span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a> <span class="n">apiEndpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-aiplatform.googleapis.com:443&quot;</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a> <span class="n">client</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">aiplatform</span><span class="o">.</span><span class="n">NewPredictionClient</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">WithEndpoint</span><span class="p">(</span><span class="n">apiEndpoint</span><span class="p">))</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct API client: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a> <span class="p">}</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a> <span class="n">defer</span> <span class="n">client</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a> <span class="n">model</span> <span class="o">:=</span> <span class="s2">&quot;multimodalembedding@001&quot;</span>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a> <span class="n">endpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;projects/</span><span class="si">%s</span><span class="s2">/locations/</span><span class="si">%s</span><span class="s2">/publishers/google/models/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a> <span class="o">//</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">to</span> <span class="n">the</span> <span class="n">model</span><span class="s1">&#39;s prediction call. For schema, see:</span>
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#request_body</span>
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a> <span class="n">instance</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">structpb</span><span class="o">.</span><span class="n">NewValue</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a> <span class="o">//</span> <span class="n">Image</span> <span class="nb">input</span> <span class="n">can</span> <span class="n">be</span> <span class="n">provided</span> <span class="n">either</span> <span class="k">as</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">Cloud</span> <span class="n">Storage</span> <span class="n">URI</span> <span class="ow">or</span> <span class="k">as</span>
</span><span id="__span-30-34"><a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a> <span class="o">//</span> <span class="n">base64</span><span class="o">-</span><span class="n">encoded</span> <span class="nb">bytes</span> <span class="n">using</span> <span class="n">the</span> <span class="s2">&quot;bytesBase64Encoded&quot;</span> <span class="n">field</span><span class="o">.</span>
</span><span id="__span-30-35"><a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai/llm/prompts/landmark1.png&quot;</span><span class="p">,</span>
</span><span id="__span-30-36"><a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a> <span class="p">},</span>
</span><span id="__span-30-37"><a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Colosseum&quot;</span><span class="p">,</span>
</span><span id="__span-30-38"><a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a> <span class="p">})</span>
</span><span id="__span-30-39"><a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-30-40"><a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct request payload: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-30-41"><a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a> <span class="p">}</span>
</span><span id="__span-30-42"><a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>
</span><span id="__span-30-43"><a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a> <span class="n">req</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">aiplatformpb</span><span class="o">.</span><span class="n">PredictRequest</span><span class="p">{</span>
</span><span id="__span-30-44"><a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a> <span class="n">Endpoint</span><span class="p">:</span> <span class="n">endpoint</span><span class="p">,</span>
</span><span id="__span-30-45"><a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a> <span class="o">//</span> <span class="n">The</span> <span class="n">model</span> <span class="n">supports</span> <span class="n">only</span> <span class="mi">1</span> <span class="n">instance</span> <span class="n">per</span> <span class="n">request</span><span class="o">.</span>
</span><span id="__span-30-46"><a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a> <span class="n">Instances</span><span class="p">:</span> <span class="p">[]</span><span class="o">*</span><span class="n">structpb</span><span class="o">.</span><span class="n">Value</span><span class="p">{</span><span class="n">instance</span><span class="p">},</span>
</span><span id="__span-30-47"><a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a> <span class="p">}</span>
</span><span id="__span-30-48"><a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a>
</span><span id="__span-30-49"><a id="__codelineno-30-49" name="__codelineno-30-49" href="#__codelineno-30-49"></a> <span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span>
</span><span id="__span-30-50"><a id="__codelineno-30-50" name="__codelineno-30-50" href="#__codelineno-30-50"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-30-51"><a id="__codelineno-30-51" name="__codelineno-30-51" href="#__codelineno-30-51"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to generate embeddings: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-30-52"><a id="__codelineno-30-52" name="__codelineno-30-52" href="#__codelineno-30-52"></a> <span class="p">}</span>
</span><span id="__span-30-53"><a id="__codelineno-30-53" name="__codelineno-30-53" href="#__codelineno-30-53"></a>
</span><span id="__span-30-54"><a id="__codelineno-30-54" name="__codelineno-30-54" href="#__codelineno-30-54"></a> <span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">protojson</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">GetPredictions</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-30-55"><a id="__codelineno-30-55" name="__codelineno-30-55" href="#__codelineno-30-55"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-30-56"><a id="__codelineno-30-56" name="__codelineno-30-56" href="#__codelineno-30-56"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to convert protobuf value to JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-30-57"><a id="__codelineno-30-57" name="__codelineno-30-57" href="#__codelineno-30-57"></a> <span class="p">}</span>
</span><span id="__span-30-58"><a id="__codelineno-30-58" name="__codelineno-30-58" href="#__codelineno-30-58"></a> <span class="o">//</span> <span class="n">For</span> <span class="n">response</span> <span class="n">schema</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span>
</span><span id="__span-30-59"><a id="__codelineno-30-59" name="__codelineno-30-59" href="#__codelineno-30-59"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#response-body</span>
</span><span id="__span-30-60"><a id="__codelineno-30-60" name="__codelineno-30-60" href="#__codelineno-30-60"></a> <span class="n">var</span> <span class="n">instanceEmbeddings</span> <span class="n">struct</span> <span class="p">{</span>
</span><span id="__span-30-61"><a id="__codelineno-30-61" name="__codelineno-30-61" href="#__codelineno-30-61"></a> <span class="n">ImageEmbeddings</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;imageEmbedding&quot;</span><span class="err">`</span>
</span><span id="__span-30-62"><a id="__codelineno-30-62" name="__codelineno-30-62" href="#__codelineno-30-62"></a> <span class="n">TextEmbeddings</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;textEmbedding&quot;</span><span class="err">`</span>
</span><span id="__span-30-63"><a id="__codelineno-30-63" name="__codelineno-30-63" href="#__codelineno-30-63"></a> <span class="p">}</span>
</span><span id="__span-30-64"><a id="__codelineno-30-64" name="__codelineno-30-64" href="#__codelineno-30-64"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">instanceEmbeddings</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-30-65"><a id="__codelineno-30-65" name="__codelineno-30-65" href="#__codelineno-30-65"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to unmarshal JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-30-66"><a id="__codelineno-30-66" name="__codelineno-30-66" href="#__codelineno-30-66"></a> <span class="p">}</span>
</span><span id="__span-30-67"><a id="__codelineno-30-67" name="__codelineno-30-67" href="#__codelineno-30-67"></a>
</span><span id="__span-30-68"><a id="__codelineno-30-68" name="__codelineno-30-68" href="#__codelineno-30-68"></a> <span class="n">imageEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">ImageEmbeddings</span>
</span><span id="__span-30-69"><a id="__codelineno-30-69" name="__codelineno-30-69" href="#__codelineno-30-69"></a> <span class="n">textEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">TextEmbeddings</span>
</span><span id="__span-30-70"><a id="__codelineno-30-70" name="__codelineno-30-70" href="#__codelineno-30-70"></a>
</span><span id="__span-30-71"><a id="__codelineno-30-71" name="__codelineno-30-71" href="#__codelineno-30-71"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Text embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">textEmbedding</span><span class="p">),</span> <span class="n">textEmbedding</span><span class="p">)</span>
</span><span id="__span-30-72"><a id="__codelineno-30-72" name="__codelineno-30-72" href="#__codelineno-30-72"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Image embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">imageEmbedding</span><span class="p">),</span> <span class="n">imageEmbedding</span><span class="p">)</span>
</span><span id="__span-30-73"><a id="__codelineno-30-73" name="__codelineno-30-73" href="#__codelineno-30-73"></a> <span class="o">//</span> <span class="n">Example</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-30-74"><a id="__codelineno-30-74" name="__codelineno-30-74" href="#__codelineno-30-74"></a> <span class="o">//</span> <span class="n">Text</span> <span class="n">embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1408</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.0023026613</span> <span class="mf">0.027898183</span> <span class="o">-</span><span class="mf">0.011858357</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-30-75"><a id="__codelineno-30-75" name="__codelineno-30-75" href="#__codelineno-30-75"></a> <span class="o">//</span> <span class="n">Image</span> <span class="n">embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1408</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.012314269</span> <span class="mf">0.07271844</span> <span class="mf">0.00020170923</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-30-76"><a id="__codelineno-30-76" name="__codelineno-30-76" href="#__codelineno-30-76"></a>
</span><span id="__span-30-77"><a id="__codelineno-30-77" name="__codelineno-30-77" href="#__codelineno-30-77"></a> <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-30-78"><a id="__codelineno-30-78" name="__codelineno-30-78" href="#__codelineno-30-78"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="send-an-embedding-request-video-image-or-text">Send an embedding request (video, image, or text)<a class="headerlink" href="#send-an-embedding-request-video-image-or-text" title="Permanent link">&para;</a></h2>
<p>When sending an embedding request you can specify an input video alone, or
you can specify a combination of video, image, and text data.</p>
<h3 id="video-embedding-modes">Video embedding modes<a class="headerlink" href="#video-embedding-modes" title="Permanent link">&para;</a></h3>
<p>There are three modes you can use with video embeddings: Essential, Standard, or
Plus. The mode corresponds to the density of the embeddings generated, which can
be specified by the <code>interval_sec</code> config in the request. For each video
interval with <code>interval_sec</code> length, an embedding is generated. The minimal
video interval length is 4 seconds. Interval lengths greater than 120 seconds
might negatively affect the quality of the generated embeddings.</p>
<p>Pricing for video embedding depends on the mode you use. For more information,
see <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">pricing</a>.</p>
<p>The following table summarizes the three modes you can use for video embeddings:</p>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Maximum number of embeddings per minute</th>
<th>Video embedding interval (minimum value)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Essential</td>
<td>4</td>
<td>15 This corresponds to: <code>intervalSec</code> &gt;= 15</td>
</tr>
<tr>
<td>Standard</td>
<td>8</td>
<td>8 This corresponds to: 8 &lt;= <code>intervalSec</code> &lt; 15</td>
</tr>
<tr>
<td>Plus</td>
<td>15</td>
<td>4 This corresponds to: 4 &lt;= <code>intervalSec</code> &lt; 8</td>
</tr>
</tbody>
</table>
<h3 id="video-embeddings-best-practices">Video embeddings best practices<a class="headerlink" href="#video-embeddings-best-practices" title="Permanent link">&para;</a></h3>
<p>Consider the following when you send video embedding requests:</p>
<ul>
<li>To generate a single embedding for the first two minutes of an input video
 of any length, use the following <code>videoSegmentConfig</code> setting:</li>
</ul>
<p><code>request.json</code>:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="o">//</span> <span class="n">other</span> <span class="n">request</span> <span class="n">body</span> <span class="n">content</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="s2">&quot;intervalSec&quot;</span><span class="p">:</span> <span class="mi">120</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="p">}</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="o">//</span> <span class="n">other</span> <span class="n">request</span> <span class="n">body</span> <span class="n">content</span>
</span></code></pre></div>
- To generate embedding for a video with a length greater than two minutes,
 you can send multiple requests that specify the start and end times in the
 <code>videoSegmentConfig</code>:</p>
<p><code>request1.json</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="o">//</span> <span class="n">other</span> <span class="n">request</span> <span class="n">body</span> <span class="n">content</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">120</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="p">}</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="o">//</span> <span class="n">other</span> <span class="n">request</span> <span class="n">body</span> <span class="n">content</span>
</span></code></pre></div>
<p><code>request2.json</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="o">//</span> <span class="n">other</span> <span class="n">request</span> <span class="n">body</span> <span class="n">content</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">240</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="p">}</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="o">//</span> <span class="n">other</span> <span class="n">request</span> <span class="n">body</span> <span class="n">content</span>
</span></code></pre></div>
<h3 id="get-video-embeddings">Get video embeddings<a class="headerlink" href="#get-video-embeddings" title="Permanent link">&para;</a></h3>
<p>Use the following sample to get embeddings for video content alone.</p>
<h3 id="rest_2">REST<a class="headerlink" href="#rest_2" title="Permanent link">&para;</a></h3>
<p>For more information about <code>multimodalembedding</code> model requests, see the
<a href="https://cloud.google.com/vertex-ai/generative-ai/docs/model-reference/multimodal-embeddings"><code>multimodalembedding</code> model API reference</a>.</p>
<p>The following example uses a video located in Cloud Storage. You can
also use the <code>video.bytesBase64Encoded</code> field to provide a
<a href="https://cloud.google.com/vertex-ai/generative-ai/docs/image/base64-encode">base64-encoded</a> string representation of the
video.</p>
<p>Before using any of the request data,
make the following replacements:</p>
<ul>
<li>LOCATION: Your project's region. For example,
 <code>us-central1</code>, <code>europe-west2</code>, or <code>asia-northeast3</code>. For a list
 of available regions, see
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/learn/locations-genai">Generative AI on Vertex AI locations</a>.</li>
<li>PROJECT_ID: Your Google Cloud <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifiers">project ID</a>.</li>
<li>VIDEO_URI: The Cloud Storage URI of the target video to get embeddings for.
 For example, <code>gs://my-bucket/embeddings/supermarket-video.mp4</code>.</li>
</ul>
<p>You can also provide the video as a
 base64-encoded byte string:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="s2">&quot;video&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="s2">&quot;bytesBase64Encoded&quot;</span><span class="p">:</span> <span class="s2">&quot;B64_ENCODED_VIDEO&quot;</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="p">}</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
- <code>videoSegmentConfig</code> (START_SECOND, END_SECOND,
 INTERVAL_SECONDS). Optional. The specific video segments (in seconds) the embeddings
 are generated for.
 The value you set for <code>videoSegmentConfig.intervalSec</code> affects
 the pricing tier you are charged at. For more information, see
 the <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-multimodal-embeddings#video-modes">video embedding modes</a> section and
 <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">pricing</a> page.</p>
<p>For example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="s2">&quot;intervalSec&quot;</span><span class="p">:</span> <span class="mi">10</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="p">}</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
<p>Using this config specifies video data from 10 seconds to 60 seconds and generates embeddings
 for the following 10 second video intervals: [10, 20), [20, 30), [30, 40), [40, 50), [50, 60).
 This video interval (<code>"intervalSec": 10</code>) falls in the
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-multimodal-embeddings#video-modes">Standard video embedding mode</a>, and the user
 is charged at the <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">Standard mode pricing rate</a>.</p>
<p>If you omit <code>videoSegmentConfig</code>, the service uses the following default values:
 <code>"videoSegmentConfig": { "startOffsetSec": 0, "endOffsetSec": 120, "intervalSec": 16 }</code>.
 This video interval (<code>"intervalSec": 16</code>) falls in the
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-multimodal-embeddings#video-modes">Essential video embedding mode</a>, and the user
 is charged at the <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">Essential mode pricing rate</a>.</p>
<p>HTTP method and URL:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">LOCATION</span><span class="o">-</span><span class="n">aiplatform</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">PROJECT_ID</span><span class="o">/</span><span class="n">locations</span><span class="o">/</span><span class="n">LOCATION</span><span class="o">/</span><span class="n">publishers</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">multimodalembedding</span><span class="o">@</span><span class="mi">001</span><span class="p">:</span><span class="n">predict</span>
</span></code></pre></div>
<p>Request JSON body:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a> <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a> <span class="p">{</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a> <span class="s2">&quot;video&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;VIDEO_URI&quot;</span><span class="p">,</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a> <span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="n">START_SECOND</span><span class="p">,</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="n">END_SECOND</span><span class="p">,</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a> <span class="s2">&quot;intervalSec&quot;</span><span class="p">:</span> <span class="n">INTERVAL_SECONDS</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a> <span class="p">}</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a> <span class="p">}</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a> <span class="p">}</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a> <span class="p">]</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="p">}</span>
</span></code></pre></div>
<p>To send your request, choose one of these options:</p>
<h4 id="curl_2">curl<a class="headerlink" href="#curl_2" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
, or by using <a href="https://cloud.google.com/shell/docs">Cloud Shell</a>,
which automatically logs you into the <code>gcloud</code> CLI
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \ 
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Authorization: Bearer $(gcloud auth print-access-token)&quot;</span> \ 
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json; charset=utf-8&quot;</span> \ 
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a> <span class="o">-</span><span class="n">d</span> <span class="nd">@request</span><span class="o">.</span><span class="n">json</span> \ 
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span>
</span></code></pre></div>
<h4 id="powershell_2">PowerShell<a class="headerlink" href="#powershell_2" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="err">$</span><span class="n">cred</span> <span class="o">=</span> <span class="n">gcloud</span> <span class="n">auth</span> <span class="nb">print</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">token</span> 
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="err">$</span><span class="n">headers</span> <span class="o">=</span> <span class="o">@</span><span class="p">{</span> <span class="s2">&quot;Authorization&quot;</span> <span class="o">=</span> <span class="s2">&quot;Bearer $cred&quot;</span> <span class="p">}</span> 
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="n">Invoke</span><span class="o">-</span><span class="n">WebRequest</span> <span class="err">`</span> 
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a> <span class="o">-</span><span class="n">Method</span> <span class="n">POST</span> <span class="err">`</span> 
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a> <span class="o">-</span><span class="n">Headers</span> <span class="err">$</span><span class="n">headers</span> <span class="err">`</span> 
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a> <span class="o">-</span><span class="n">ContentType</span><span class="p">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span> <span class="err">`</span> 
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a> <span class="o">-</span><span class="n">InFile</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="err">`</span> 
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a> <span class="o">-</span><span class="n">Uri</span> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span> <span class="o">|</span> <span class="n">Select</span><span class="o">-</span><span class="n">Object</span> <span class="o">-</span><span class="n">Expand</span> <span class="n">Content</span>
</span></code></pre></div>
<p>The embedding the model returns is a 1408 float vector. The following sample responses are shortened
for space.</p>
<p><strong>Response (7 second video, no <code>videoSegmentConfig</code> specified):</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="p">{</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a> <span class="p">{</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a> <span class="s2">&quot;videoEmbeddings&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a> <span class="p">{</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a> <span class="o">-</span><span class="mf">0.0045467657</span><span class="p">,</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a> <span class="mf">0.0258095954</span><span class="p">,</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a> <span class="mf">0.0146885719</span><span class="p">,</span>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a> <span class="mf">0.00945400633</span><span class="p">,</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a> <span class="o">-</span><span class="mf">0.0023291884</span><span class="p">,</span>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a> <span class="o">-</span><span class="mf">0.00493789</span><span class="p">,</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a> <span class="mf">0.00975185353</span><span class="p">,</span>
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a> <span class="mf">0.0168156829</span>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a> <span class="p">],</span>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a> <span class="p">}</span>
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a> <span class="p">]</span>
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a> <span class="p">}</span>
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a> <span class="p">],</span>
</span><span id="__span-40-23"><a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-40-24"><a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Response (59 second video, with the following video segment config: <code>"videoSegmentConfig": { "startOffsetSec": 0, "endOffsetSec": 60, "intervalSec": 10 }</code>):</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="p">{</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a> <span class="p">{</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a> <span class="s2">&quot;videoEmbeddings&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a> <span class="p">{</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a> <span class="o">-</span><span class="mf">0.00683252793</span><span class="p">,</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a> <span class="mf">0.0390476175</span><span class="p">,</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a> <span class="mf">0.00657121744</span><span class="p">,</span>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a> <span class="mf">0.013023301</span>
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a> <span class="p">]</span>
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a> <span class="p">},</span>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a> <span class="p">{</span>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a> <span class="o">-</span><span class="mf">0.0104404651</span><span class="p">,</span>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a> <span class="mf">0.0357737206</span><span class="p">,</span>
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-41-23"><a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a> <span class="mf">0.00509833824</span><span class="p">,</span>
</span><span id="__span-41-24"><a id="__codelineno-41-24" name="__codelineno-41-24" href="#__codelineno-41-24"></a> <span class="mf">0.0131902946</span>
</span><span id="__span-41-25"><a id="__codelineno-41-25" name="__codelineno-41-25" href="#__codelineno-41-25"></a> <span class="p">]</span>
</span><span id="__span-41-26"><a id="__codelineno-41-26" name="__codelineno-41-26" href="#__codelineno-41-26"></a> <span class="p">},</span>
</span><span id="__span-41-27"><a id="__codelineno-41-27" name="__codelineno-41-27" href="#__codelineno-41-27"></a> <span class="p">{</span>
</span><span id="__span-41-28"><a id="__codelineno-41-28" name="__codelineno-41-28" href="#__codelineno-41-28"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span><span id="__span-41-29"><a id="__codelineno-41-29" name="__codelineno-41-29" href="#__codelineno-41-29"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-30"><a id="__codelineno-41-30" name="__codelineno-41-30" href="#__codelineno-41-30"></a> <span class="o">-</span><span class="mf">0.0113538112</span><span class="p">,</span>
</span><span id="__span-41-31"><a id="__codelineno-41-31" name="__codelineno-41-31" href="#__codelineno-41-31"></a> <span class="mf">0.0305239167</span><span class="p">,</span>
</span><span id="__span-41-32"><a id="__codelineno-41-32" name="__codelineno-41-32" href="#__codelineno-41-32"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-41-33"><a id="__codelineno-41-33" name="__codelineno-41-33" href="#__codelineno-41-33"></a> <span class="o">-</span><span class="mf">0.00195809244</span><span class="p">,</span>
</span><span id="__span-41-34"><a id="__codelineno-41-34" name="__codelineno-41-34" href="#__codelineno-41-34"></a> <span class="mf">0.00941874553</span>
</span><span id="__span-41-35"><a id="__codelineno-41-35" name="__codelineno-41-35" href="#__codelineno-41-35"></a> <span class="p">],</span>
</span><span id="__span-41-36"><a id="__codelineno-41-36" name="__codelineno-41-36" href="#__codelineno-41-36"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">30</span>
</span><span id="__span-41-37"><a id="__codelineno-41-37" name="__codelineno-41-37" href="#__codelineno-41-37"></a> <span class="p">},</span>
</span><span id="__span-41-38"><a id="__codelineno-41-38" name="__codelineno-41-38" href="#__codelineno-41-38"></a> <span class="p">{</span>
</span><span id="__span-41-39"><a id="__codelineno-41-39" name="__codelineno-41-39" href="#__codelineno-41-39"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-40"><a id="__codelineno-41-40" name="__codelineno-41-40" href="#__codelineno-41-40"></a> <span class="o">-</span><span class="mf">0.00299320649</span><span class="p">,</span>
</span><span id="__span-41-41"><a id="__codelineno-41-41" name="__codelineno-41-41" href="#__codelineno-41-41"></a> <span class="mf">0.0322436653</span><span class="p">,</span>
</span><span id="__span-41-42"><a id="__codelineno-41-42" name="__codelineno-41-42" href="#__codelineno-41-42"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-41-43"><a id="__codelineno-41-43" name="__codelineno-41-43" href="#__codelineno-41-43"></a> <span class="o">-</span><span class="mf">0.00993082579</span><span class="p">,</span>
</span><span id="__span-41-44"><a id="__codelineno-41-44" name="__codelineno-41-44" href="#__codelineno-41-44"></a> <span class="mf">0.00968887936</span>
</span><span id="__span-41-45"><a id="__codelineno-41-45" name="__codelineno-41-45" href="#__codelineno-41-45"></a> <span class="p">],</span>
</span><span id="__span-41-46"><a id="__codelineno-41-46" name="__codelineno-41-46" href="#__codelineno-41-46"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="__span-41-47"><a id="__codelineno-41-47" name="__codelineno-41-47" href="#__codelineno-41-47"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">40</span>
</span><span id="__span-41-48"><a id="__codelineno-41-48" name="__codelineno-41-48" href="#__codelineno-41-48"></a> <span class="p">},</span>
</span><span id="__span-41-49"><a id="__codelineno-41-49" name="__codelineno-41-49" href="#__codelineno-41-49"></a> <span class="p">{</span>
</span><span id="__span-41-50"><a id="__codelineno-41-50" name="__codelineno-41-50" href="#__codelineno-41-50"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
</span><span id="__span-41-51"><a id="__codelineno-41-51" name="__codelineno-41-51" href="#__codelineno-41-51"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="__span-41-52"><a id="__codelineno-41-52" name="__codelineno-41-52" href="#__codelineno-41-52"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-53"><a id="__codelineno-41-53" name="__codelineno-41-53" href="#__codelineno-41-53"></a> <span class="o">-</span><span class="mf">0.00591270532</span><span class="p">,</span>
</span><span id="__span-41-54"><a id="__codelineno-41-54" name="__codelineno-41-54" href="#__codelineno-41-54"></a> <span class="mf">0.0368893594</span><span class="p">,</span>
</span><span id="__span-41-55"><a id="__codelineno-41-55" name="__codelineno-41-55" href="#__codelineno-41-55"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-41-56"><a id="__codelineno-41-56" name="__codelineno-41-56" href="#__codelineno-41-56"></a> <span class="o">-</span><span class="mf">0.00219071587</span><span class="p">,</span>
</span><span id="__span-41-57"><a id="__codelineno-41-57" name="__codelineno-41-57" href="#__codelineno-41-57"></a> <span class="mf">0.0042470959</span>
</span><span id="__span-41-58"><a id="__codelineno-41-58" name="__codelineno-41-58" href="#__codelineno-41-58"></a> <span class="p">]</span>
</span><span id="__span-41-59"><a id="__codelineno-41-59" name="__codelineno-41-59" href="#__codelineno-41-59"></a> <span class="p">},</span>
</span><span id="__span-41-60"><a id="__codelineno-41-60" name="__codelineno-41-60" href="#__codelineno-41-60"></a> <span class="p">{</span>
</span><span id="__span-41-61"><a id="__codelineno-41-61" name="__codelineno-41-61" href="#__codelineno-41-61"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-41-62"><a id="__codelineno-41-62" name="__codelineno-41-62" href="#__codelineno-41-62"></a> <span class="o">-</span><span class="mf">0.00458270218</span><span class="p">,</span>
</span><span id="__span-41-63"><a id="__codelineno-41-63" name="__codelineno-41-63" href="#__codelineno-41-63"></a> <span class="mf">0.0368121453</span><span class="p">,</span>
</span><span id="__span-41-64"><a id="__codelineno-41-64" name="__codelineno-41-64" href="#__codelineno-41-64"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-41-65"><a id="__codelineno-41-65" name="__codelineno-41-65" href="#__codelineno-41-65"></a> <span class="o">-</span><span class="mf">0.00317760976</span><span class="p">,</span>
</span><span id="__span-41-66"><a id="__codelineno-41-66" name="__codelineno-41-66" href="#__codelineno-41-66"></a> <span class="mf">0.00595594104</span>
</span><span id="__span-41-67"><a id="__codelineno-41-67" name="__codelineno-41-67" href="#__codelineno-41-67"></a> <span class="p">],</span>
</span><span id="__span-41-68"><a id="__codelineno-41-68" name="__codelineno-41-68" href="#__codelineno-41-68"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">59</span><span class="p">,</span>
</span><span id="__span-41-69"><a id="__codelineno-41-69" name="__codelineno-41-69" href="#__codelineno-41-69"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">50</span>
</span><span id="__span-41-70"><a id="__codelineno-41-70" name="__codelineno-41-70" href="#__codelineno-41-70"></a> <span class="p">}</span>
</span><span id="__span-41-71"><a id="__codelineno-41-71" name="__codelineno-41-71" href="#__codelineno-41-71"></a> <span class="p">]</span>
</span><span id="__span-41-72"><a id="__codelineno-41-72" name="__codelineno-41-72" href="#__codelineno-41-72"></a> <span class="p">}</span>
</span><span id="__span-41-73"><a id="__codelineno-41-73" name="__codelineno-41-73" href="#__codelineno-41-73"></a> <span class="p">],</span>
</span><span id="__span-41-74"><a id="__codelineno-41-74" name="__codelineno-41-74" href="#__codelineno-41-74"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-41-75"><a id="__codelineno-41-75" name="__codelineno-41-75" href="#__codelineno-41-75"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="vertex-ai-sdk-for-python_1">Vertex AI SDK for Python<a class="headerlink" href="#vertex-ai-sdk-for-python_1" title="Permanent link">&para;</a></h3>
<p>To learn how to install or update the Vertex AI SDK for Python, see <a href="https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk">Install the Vertex AI SDK for Python</a>.
For more information, see the
<a href="https://cloud.google.com/python/docs/reference/aiplatform/latest">Vertex AI SDK for Python API reference documentation</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">vertexai</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">vertexai.vision_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiModalEmbeddingModel</span><span class="p">,</span> <span class="n">Video</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">vertexai.vision_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">VideoSegmentConfig</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="c1"># TODO(developer): Update &amp; uncomment line below</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="c1"># PROJECT_ID = &quot;your-project-id&quot;</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="n">vertexai</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;us-central1&quot;</span><span class="p">)</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MultiModalEmbeddingModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;multimodalembedding@001&quot;</span><span class="p">)</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="n">embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">(</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a> <span class="n">video</span><span class="o">=</span><span class="n">Video</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai-vision/highway_vehicles.mp4&quot;</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a> <span class="p">),</span>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a> <span class="n">video_segment_config</span><span class="o">=</span><span class="n">VideoSegmentConfig</span><span class="p">(</span><span class="n">end_offset_sec</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="p">)</span>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="c1"># Video Embeddings are segmented based on the video_segment_config.</span>
</span><span id="__span-42-20"><a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video Embeddings:&quot;</span><span class="p">)</span>
</span><span id="__span-42-21"><a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="k">for</span> <span class="n">video_embedding</span> <span class="ow">in</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">video_embeddings</span><span class="p">:</span>
</span><span id="__span-42-22"><a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a> <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-42-23"><a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a> <span class="sa">f</span><span class="s2">&quot;Video Segment: </span><span class="si">{</span><span class="n">video_embedding</span><span class="o">.</span><span class="n">start_offset_sec</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">video_embedding</span><span class="o">.</span><span class="n">end_offset_sec</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-42-24"><a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a> <span class="p">)</span>
</span><span id="__span-42-25"><a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Embedding: </span><span class="si">{</span><span class="n">video_embedding</span><span class="o">.</span><span class="n">embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-42-26"><a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a>
</span><span id="__span-42-27"><a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a><span class="c1"># Example response:</span>
</span><span id="__span-42-28"><a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a><span class="c1"># Video Embeddings:</span>
</span><span id="__span-42-29"><a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a><span class="c1"># Video Segment: 0.0 - 1.0</span>
</span><span id="__span-42-30"><a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a><span class="c1"># Embedding: [-0.0206376351, 0.0123456789, ...]</span>
</span></code></pre></div>
<h3 id="go_2">Go<a class="headerlink" href="#go_2" title="Permanent link">&para;</a></h3>
<p>Before trying this sample, follow the Go setup instructions in the
<a href="https://cloud.google.com/vertex-ai/docs/start/client-libraries">Vertex AI quickstart using
client libraries</a>.
For more information, see the
<a href="/go/docs/reference/cloud.google.com/go/aiplatform/latest/apiv1">Vertex AI Go API
reference documentation</a>.</p>
<p>To authenticate to Vertex AI, set up Application Default Credentials.
For more information, see
<a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up authentication for a local development environment</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a> <span class="s2">&quot;context&quot;</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a> <span class="s2">&quot;encoding/json&quot;</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a> <span class="s2">&quot;fmt&quot;</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a> <span class="s2">&quot;io&quot;</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a> <span class="s2">&quot;time&quot;</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a> <span class="n">aiplatform</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1&quot;</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a> <span class="n">aiplatformpb</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1/aiplatformpb&quot;</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a> <span class="s2">&quot;google.golang.org/api/option&quot;</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a> <span class="s2">&quot;google.golang.org/protobuf/encoding/protojson&quot;</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a> <span class="s2">&quot;google.golang.org/protobuf/types/known/structpb&quot;</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="p">)</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="o">//</span> <span class="n">generateForVideo</span> <span class="n">shows</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="n">multimodal</span> <span class="n">model</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">embeddings</span> <span class="k">for</span> <span class="n">video</span> <span class="nb">input</span><span class="o">.</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="n">func</span> <span class="n">generateForVideo</span><span class="p">(</span><span class="n">w</span> <span class="n">io</span><span class="o">.</span><span class="n">Writer</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span> <span class="n">string</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a> <span class="o">//</span> <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span>
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>
</span><span id="__span-43-19"><a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a> <span class="o">//</span> <span class="n">The</span> <span class="n">default</span> <span class="n">context</span> <span class="n">timeout</span> <span class="n">may</span> <span class="n">be</span> <span class="ow">not</span> <span class="n">enough</span> <span class="n">to</span> <span class="n">process</span> <span class="n">a</span> <span class="n">video</span> <span class="nb">input</span><span class="o">.</span>
</span><span id="__span-43-20"><a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a> <span class="n">ctx</span><span class="p">,</span> <span class="n">cancel</span> <span class="o">:=</span> <span class="n">context</span><span class="o">.</span><span class="n">WithTimeout</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">(),</span> <span class="mi">15</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span>
</span><span id="__span-43-21"><a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a> <span class="n">defer</span> <span class="n">cancel</span><span class="p">()</span>
</span><span id="__span-43-22"><a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a>
</span><span id="__span-43-23"><a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a> <span class="n">apiEndpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-aiplatform.googleapis.com:443&quot;</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
</span><span id="__span-43-24"><a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a> <span class="n">client</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">aiplatform</span><span class="o">.</span><span class="n">NewPredictionClient</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">WithEndpoint</span><span class="p">(</span><span class="n">apiEndpoint</span><span class="p">))</span>
</span><span id="__span-43-25"><a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-43-26"><a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct API client: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-43-27"><a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a> <span class="p">}</span>
</span><span id="__span-43-28"><a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a> <span class="n">defer</span> <span class="n">client</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</span><span id="__span-43-29"><a id="__codelineno-43-29" name="__codelineno-43-29" href="#__codelineno-43-29"></a>
</span><span id="__span-43-30"><a id="__codelineno-43-30" name="__codelineno-43-30" href="#__codelineno-43-30"></a> <span class="n">model</span> <span class="o">:=</span> <span class="s2">&quot;multimodalembedding@001&quot;</span>
</span><span id="__span-43-31"><a id="__codelineno-43-31" name="__codelineno-43-31" href="#__codelineno-43-31"></a> <span class="n">endpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;projects/</span><span class="si">%s</span><span class="s2">/locations/</span><span class="si">%s</span><span class="s2">/publishers/google/models/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="__span-43-32"><a id="__codelineno-43-32" name="__codelineno-43-32" href="#__codelineno-43-32"></a>
</span><span id="__span-43-33"><a id="__codelineno-43-33" name="__codelineno-43-33" href="#__codelineno-43-33"></a> <span class="o">//</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">to</span> <span class="n">the</span> <span class="n">model</span><span class="s1">&#39;s prediction call. For schema, see:</span>
</span><span id="__span-43-34"><a id="__codelineno-43-34" name="__codelineno-43-34" href="#__codelineno-43-34"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#request_body</span>
</span><span id="__span-43-35"><a id="__codelineno-43-35" name="__codelineno-43-35" href="#__codelineno-43-35"></a> <span class="n">instances</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">structpb</span><span class="o">.</span><span class="n">NewValue</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-43-36"><a id="__codelineno-43-36" name="__codelineno-43-36" href="#__codelineno-43-36"></a> <span class="s2">&quot;video&quot;</span><span class="p">:</span> <span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-43-37"><a id="__codelineno-43-37" name="__codelineno-43-37" href="#__codelineno-43-37"></a> <span class="o">//</span> <span class="n">Video</span> <span class="nb">input</span> <span class="n">can</span> <span class="n">be</span> <span class="n">provided</span> <span class="n">either</span> <span class="k">as</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">Cloud</span> <span class="n">Storage</span> <span class="n">URI</span> <span class="ow">or</span> <span class="k">as</span> <span class="n">base64</span><span class="o">-</span><span class="n">encoded</span>
</span><span id="__span-43-38"><a id="__codelineno-43-38" name="__codelineno-43-38" href="#__codelineno-43-38"></a> <span class="o">//</span> <span class="nb">bytes</span> <span class="n">using</span> <span class="n">the</span> <span class="s2">&quot;bytesBase64Encoded&quot;</span> <span class="n">field</span><span class="o">.</span>
</span><span id="__span-43-39"><a id="__codelineno-43-39" name="__codelineno-43-39" href="#__codelineno-43-39"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai-vision/highway_vehicles.mp4&quot;</span><span class="p">,</span>
</span><span id="__span-43-40"><a id="__codelineno-43-40" name="__codelineno-43-40" href="#__codelineno-43-40"></a> <span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-43-41"><a id="__codelineno-43-41" name="__codelineno-43-41" href="#__codelineno-43-41"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-43-42"><a id="__codelineno-43-42" name="__codelineno-43-42" href="#__codelineno-43-42"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span id="__span-43-43"><a id="__codelineno-43-43" name="__codelineno-43-43" href="#__codelineno-43-43"></a> <span class="p">},</span>
</span><span id="__span-43-44"><a id="__codelineno-43-44" name="__codelineno-43-44" href="#__codelineno-43-44"></a> <span class="p">},</span>
</span><span id="__span-43-45"><a id="__codelineno-43-45" name="__codelineno-43-45" href="#__codelineno-43-45"></a> <span class="p">})</span>
</span><span id="__span-43-46"><a id="__codelineno-43-46" name="__codelineno-43-46" href="#__codelineno-43-46"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-43-47"><a id="__codelineno-43-47" name="__codelineno-43-47" href="#__codelineno-43-47"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct request payload: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-43-48"><a id="__codelineno-43-48" name="__codelineno-43-48" href="#__codelineno-43-48"></a> <span class="p">}</span>
</span><span id="__span-43-49"><a id="__codelineno-43-49" name="__codelineno-43-49" href="#__codelineno-43-49"></a>
</span><span id="__span-43-50"><a id="__codelineno-43-50" name="__codelineno-43-50" href="#__codelineno-43-50"></a> <span class="n">req</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">aiplatformpb</span><span class="o">.</span><span class="n">PredictRequest</span><span class="p">{</span>
</span><span id="__span-43-51"><a id="__codelineno-43-51" name="__codelineno-43-51" href="#__codelineno-43-51"></a> <span class="n">Endpoint</span><span class="p">:</span> <span class="n">endpoint</span><span class="p">,</span>
</span><span id="__span-43-52"><a id="__codelineno-43-52" name="__codelineno-43-52" href="#__codelineno-43-52"></a> <span class="o">//</span> <span class="n">The</span> <span class="n">model</span> <span class="n">supports</span> <span class="n">only</span> <span class="mi">1</span> <span class="n">instance</span> <span class="n">per</span> <span class="n">request</span><span class="o">.</span>
</span><span id="__span-43-53"><a id="__codelineno-43-53" name="__codelineno-43-53" href="#__codelineno-43-53"></a> <span class="n">Instances</span><span class="p">:</span> <span class="p">[]</span><span class="o">*</span><span class="n">structpb</span><span class="o">.</span><span class="n">Value</span><span class="p">{</span><span class="n">instances</span><span class="p">},</span>
</span><span id="__span-43-54"><a id="__codelineno-43-54" name="__codelineno-43-54" href="#__codelineno-43-54"></a> <span class="p">}</span>
</span><span id="__span-43-55"><a id="__codelineno-43-55" name="__codelineno-43-55" href="#__codelineno-43-55"></a> <span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span>
</span><span id="__span-43-56"><a id="__codelineno-43-56" name="__codelineno-43-56" href="#__codelineno-43-56"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-43-57"><a id="__codelineno-43-57" name="__codelineno-43-57" href="#__codelineno-43-57"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to generate embeddings: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-43-58"><a id="__codelineno-43-58" name="__codelineno-43-58" href="#__codelineno-43-58"></a> <span class="p">}</span>
</span><span id="__span-43-59"><a id="__codelineno-43-59" name="__codelineno-43-59" href="#__codelineno-43-59"></a>
</span><span id="__span-43-60"><a id="__codelineno-43-60" name="__codelineno-43-60" href="#__codelineno-43-60"></a> <span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">protojson</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">GetPredictions</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-43-61"><a id="__codelineno-43-61" name="__codelineno-43-61" href="#__codelineno-43-61"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-43-62"><a id="__codelineno-43-62" name="__codelineno-43-62" href="#__codelineno-43-62"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to convert protobuf value to JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-43-63"><a id="__codelineno-43-63" name="__codelineno-43-63" href="#__codelineno-43-63"></a> <span class="p">}</span>
</span><span id="__span-43-64"><a id="__codelineno-43-64" name="__codelineno-43-64" href="#__codelineno-43-64"></a> <span class="o">//</span> <span class="n">For</span> <span class="n">response</span> <span class="n">schema</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span>
</span><span id="__span-43-65"><a id="__codelineno-43-65" name="__codelineno-43-65" href="#__codelineno-43-65"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#response-body</span>
</span><span id="__span-43-66"><a id="__codelineno-43-66" name="__codelineno-43-66" href="#__codelineno-43-66"></a> <span class="n">var</span> <span class="n">instanceEmbeddings</span> <span class="n">struct</span> <span class="p">{</span>
</span><span id="__span-43-67"><a id="__codelineno-43-67" name="__codelineno-43-67" href="#__codelineno-43-67"></a> <span class="n">VideoEmbeddings</span> <span class="p">[]</span><span class="n">struct</span> <span class="p">{</span>
</span><span id="__span-43-68"><a id="__codelineno-43-68" name="__codelineno-43-68" href="#__codelineno-43-68"></a> <span class="n">Embedding</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;embedding&quot;</span><span class="err">`</span>
</span><span id="__span-43-69"><a id="__codelineno-43-69" name="__codelineno-43-69" href="#__codelineno-43-69"></a> <span class="n">StartOffsetSec</span> <span class="n">float64</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;startOffsetSec&quot;</span><span class="err">`</span>
</span><span id="__span-43-70"><a id="__codelineno-43-70" name="__codelineno-43-70" href="#__codelineno-43-70"></a> <span class="n">EndOffsetSec</span> <span class="n">float64</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;endOffsetSec&quot;</span><span class="err">`</span>
</span><span id="__span-43-71"><a id="__codelineno-43-71" name="__codelineno-43-71" href="#__codelineno-43-71"></a> <span class="p">}</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;videoEmbeddings&quot;</span><span class="err">`</span>
</span><span id="__span-43-72"><a id="__codelineno-43-72" name="__codelineno-43-72" href="#__codelineno-43-72"></a> <span class="p">}</span>
</span><span id="__span-43-73"><a id="__codelineno-43-73" name="__codelineno-43-73" href="#__codelineno-43-73"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">instanceEmbeddings</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-43-74"><a id="__codelineno-43-74" name="__codelineno-43-74" href="#__codelineno-43-74"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to unmarshal json: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-43-75"><a id="__codelineno-43-75" name="__codelineno-43-75" href="#__codelineno-43-75"></a> <span class="p">}</span>
</span><span id="__span-43-76"><a id="__codelineno-43-76" name="__codelineno-43-76" href="#__codelineno-43-76"></a> <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">embedding</span> <span class="k">for</span> <span class="n">our</span> <span class="n">single</span> <span class="n">video</span> <span class="n">segment</span> <span class="p">(</span><span class="err">`</span><span class="o">.</span><span class="n">videoEmbeddings</span><span class="err">`</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">one</span> <span class="n">entry</span> <span class="n">per</span>
</span><span id="__span-43-77"><a id="__codelineno-43-77" name="__codelineno-43-77" href="#__codelineno-43-77"></a> <span class="o">//</span> <span class="n">each</span> <span class="n">processed</span> <span class="n">segment</span><span class="p">)</span><span class="o">.</span>
</span><span id="__span-43-78"><a id="__codelineno-43-78" name="__codelineno-43-78" href="#__codelineno-43-78"></a> <span class="n">videoEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">VideoEmbeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-43-79"><a id="__codelineno-43-79" name="__codelineno-43-79" href="#__codelineno-43-79"></a>
</span><span id="__span-43-80"><a id="__codelineno-43-80" name="__codelineno-43-80" href="#__codelineno-43-80"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Video embedding (seconds: %.f-%.f; length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-43-81"><a id="__codelineno-43-81" name="__codelineno-43-81" href="#__codelineno-43-81"></a> <span class="n">videoEmbedding</span><span class="o">.</span><span class="n">StartOffsetSec</span><span class="p">,</span>
</span><span id="__span-43-82"><a id="__codelineno-43-82" name="__codelineno-43-82" href="#__codelineno-43-82"></a> <span class="n">videoEmbedding</span><span class="o">.</span><span class="n">EndOffsetSec</span><span class="p">,</span>
</span><span id="__span-43-83"><a id="__codelineno-43-83" name="__codelineno-43-83" href="#__codelineno-43-83"></a> <span class="nb">len</span><span class="p">(</span><span class="n">videoEmbedding</span><span class="o">.</span><span class="n">Embedding</span><span class="p">),</span>
</span><span id="__span-43-84"><a id="__codelineno-43-84" name="__codelineno-43-84" href="#__codelineno-43-84"></a> <span class="n">videoEmbedding</span><span class="o">.</span><span class="n">Embedding</span><span class="p">,</span>
</span><span id="__span-43-85"><a id="__codelineno-43-85" name="__codelineno-43-85" href="#__codelineno-43-85"></a> <span class="p">)</span>
</span><span id="__span-43-86"><a id="__codelineno-43-86" name="__codelineno-43-86" href="#__codelineno-43-86"></a> <span class="o">//</span> <span class="n">Example</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-43-87"><a id="__codelineno-43-87" name="__codelineno-43-87" href="#__codelineno-43-87"></a> <span class="o">//</span> <span class="n">Video</span> <span class="n">embedding</span> <span class="p">(</span><span class="n">seconds</span><span class="p">:</span> <span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1408</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.016427778</span> <span class="mf">0.032878537</span> <span class="o">-</span><span class="mf">0.030755188</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-43-88"><a id="__codelineno-43-88" name="__codelineno-43-88" href="#__codelineno-43-88"></a>
</span><span id="__span-43-89"><a id="__codelineno-43-89" name="__codelineno-43-89" href="#__codelineno-43-89"></a> <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-43-90"><a id="__codelineno-43-90" name="__codelineno-43-90" href="#__codelineno-43-90"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="get-image-text-and-video-embeddings">Get image, text, and video embeddings<a class="headerlink" href="#get-image-text-and-video-embeddings" title="Permanent link">&para;</a></h3>
<p>Use the following sample to get embeddings for video, text, and image content.</p>
<h3 id="rest_3">REST<a class="headerlink" href="#rest_3" title="Permanent link">&para;</a></h3>
<p>For more information about <code>multimodalembedding</code> model requests, see the
<a href="https://cloud.google.com/vertex-ai/generative-ai/docs/model-reference/multimodal-embeddings"><code>multimodalembedding</code> model API reference</a>.</p>
<p>The following example uses image, text, and video data. You can use any
combination of these data types in your request body.</p>
<p>Additionally, this
sample uses a video located in Cloud Storage. You can
also use the <code>video.bytesBase64Encoded</code> field to provide a
<a href="https://cloud.google.com/vertex-ai/generative-ai/docs/image/base64-encode">base64-encoded</a> string representation of the
video.</p>
<p>Before using any of the request data,
make the following replacements:</p>
<ul>
<li>LOCATION: Your project's region. For example,
 <code>us-central1</code>, <code>europe-west2</code>, or <code>asia-northeast3</code>. For a list
 of available regions, see
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/learn/locations-genai">Generative AI on Vertex AI locations</a>.</li>
<li>PROJECT_ID: Your Google Cloud <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifiers">project ID</a>.</li>
<li>TEXT: The target text to get embeddings for. For example,
 <code>a cat</code>.</li>
<li>IMAGE_URI: The Cloud Storage URI of the target image to get embeddings for.
 For example, <code>gs://my-bucket/embeddings/supermarket-img.png</code>.</li>
</ul>
<p>You can also provide the image as a
 base64-encoded byte string:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="s2">&quot;bytesBase64Encoded&quot;</span><span class="p">:</span> <span class="s2">&quot;B64_ENCODED_IMAGE&quot;</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="p">}</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
- VIDEO_URI: The Cloud Storage URI of the target video to get embeddings for.
 For example, <code>gs://my-bucket/embeddings/supermarket-video.mp4</code>.</p>
<p>You can also provide the video as a
 base64-encoded byte string:</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="s2">&quot;video&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="s2">&quot;bytesBase64Encoded&quot;</span><span class="p">:</span> <span class="s2">&quot;B64_ENCODED_VIDEO&quot;</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="p">}</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
- <code>videoSegmentConfig</code> (START_SECOND, END_SECOND,
 INTERVAL_SECONDS). Optional. The specific video segments (in seconds) the embeddings
 are generated for.
 The value you set for <code>videoSegmentConfig.intervalSec</code> affects
 the pricing tier you are charged at. For more information, see
 the <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-multimodal-embeddings#video-modes">video embedding modes</a> section and
 <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">pricing</a> page.</p>
<p>For example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="s2">&quot;intervalSec&quot;</span><span class="p">:</span> <span class="mi">10</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="p">}</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
<p>Using this config specifies video data from 10 seconds to 60 seconds and generates embeddings
 for the following 10 second video intervals: [10, 20), [20, 30), [30, 40), [40, 50), [50, 60).
 This video interval (<code>"intervalSec": 10</code>) falls in the
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-multimodal-embeddings#video-modes">Standard video embedding mode</a>, and the user
 is charged at the <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">Standard mode pricing rate</a>.</p>
<p>If you omit <code>videoSegmentConfig</code>, the service uses the following default values:
 <code>"videoSegmentConfig": { "startOffsetSec": 0, "endOffsetSec": 120, "intervalSec": 16 }</code>.
 This video interval (<code>"intervalSec": 16</code>) falls in the
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-multimodal-embeddings#video-modes">Essential video embedding mode</a>, and the user
 is charged at the <a href="https://cloud.google.com/vertex-ai/generative-ai/pricing">Essential mode pricing rate</a>.</p>
<p>HTTP method and URL:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">LOCATION</span><span class="o">-</span><span class="n">aiplatform</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">PROJECT_ID</span><span class="o">/</span><span class="n">locations</span><span class="o">/</span><span class="n">LOCATION</span><span class="o">/</span><span class="n">publishers</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">multimodalembedding</span><span class="o">@</span><span class="mi">001</span><span class="p">:</span><span class="n">predict</span>
</span></code></pre></div>
<p>Request JSON body:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="p">{</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a> <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a> <span class="p">{</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;IMAGE_URI&quot;</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a> <span class="p">},</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a> <span class="s2">&quot;video&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;VIDEO_URI&quot;</span><span class="p">,</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a> <span class="s2">&quot;videoSegmentConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="n">START_SECOND</span><span class="p">,</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="n">END_SECOND</span><span class="p">,</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a> <span class="s2">&quot;intervalSec&quot;</span><span class="p">:</span> <span class="n">INTERVAL_SECONDS</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a> <span class="p">}</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a> <span class="p">}</span>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a> <span class="p">}</span>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a> <span class="p">]</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="p">}</span>
</span></code></pre></div>
<p>To send your request, choose one of these options:</p>
<h4 id="curl_3">curl<a class="headerlink" href="#curl_3" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
, or by using <a href="https://cloud.google.com/shell/docs">Cloud Shell</a>,
which automatically logs you into the <code>gcloud</code> CLI
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \ 
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Authorization: Bearer $(gcloud auth print-access-token)&quot;</span> \ 
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json; charset=utf-8&quot;</span> \ 
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a> <span class="o">-</span><span class="n">d</span> <span class="nd">@request</span><span class="o">.</span><span class="n">json</span> \ 
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span>
</span></code></pre></div>
<h4 id="powershell_3">PowerShell<a class="headerlink" href="#powershell_3" title="Permanent link">&para;</a></h4>
<p><strong>Note:</strong>
The following command assumes that you have logged in to
the <code>gcloud</code> CLI with your user account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/init"><code>gcloud init</code></a>
or
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/login"><code>gcloud auth login</code></a>
.
You can check the currently active account by running
<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list"><code>gcloud auth list</code></a>.</p>
<p>Save the request body in a file named <code>request.json</code>,
and execute the following command:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="err">$</span><span class="n">cred</span> <span class="o">=</span> <span class="n">gcloud</span> <span class="n">auth</span> <span class="nb">print</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">token</span> 
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="err">$</span><span class="n">headers</span> <span class="o">=</span> <span class="o">@</span><span class="p">{</span> <span class="s2">&quot;Authorization&quot;</span> <span class="o">=</span> <span class="s2">&quot;Bearer $cred&quot;</span> <span class="p">}</span> 
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="n">Invoke</span><span class="o">-</span><span class="n">WebRequest</span> <span class="err">`</span> 
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a> <span class="o">-</span><span class="n">Method</span> <span class="n">POST</span> <span class="err">`</span> 
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a> <span class="o">-</span><span class="n">Headers</span> <span class="err">$</span><span class="n">headers</span> <span class="err">`</span> 
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a> <span class="o">-</span><span class="n">ContentType</span><span class="p">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span> <span class="err">`</span> 
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a> <span class="o">-</span><span class="n">InFile</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="err">`</span> 
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a> <span class="o">-</span><span class="n">Uri</span> <span class="s2">&quot;https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/multimodalembedding@001:predict&quot;</span> <span class="o">|</span> <span class="n">Select</span><span class="o">-</span><span class="n">Object</span> <span class="o">-</span><span class="n">Expand</span> <span class="n">Content</span>
</span></code></pre></div>
<p>The embedding the model returns is a 1408 float vector. The following sample response is shortened
for space.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="p">{</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a> <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a> <span class="p">{</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a> <span class="s2">&quot;textEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a> <span class="mf">0.0105433334</span><span class="p">,</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a> <span class="o">-</span><span class="mf">0.00302835181</span><span class="p">,</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a> <span class="mf">0.00656806398</span><span class="p">,</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a> <span class="mf">0.00603460241</span><span class="p">,</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a> <span class="mf">0.00445805816</span><span class="p">,</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a> <span class="mf">0.0139605571</span><span class="p">,</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a> <span class="o">-</span><span class="mf">0.00170318608</span><span class="p">,</span>
</span><span id="__span-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a> <span class="o">-</span><span class="mf">0.00490092579</span>
</span><span id="__span-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a> <span class="p">],</span>
</span><span id="__span-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a> <span class="s2">&quot;videoEmbeddings&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a> <span class="p">{</span>
</span><span id="__span-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a> <span class="s2">&quot;startOffsetSec&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a> <span class="s2">&quot;endOffsetSec&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
</span><span id="__span-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a> <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-51-20"><a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a> <span class="o">-</span><span class="mf">0.00673126569</span><span class="p">,</span>
</span><span id="__span-51-21"><a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a> <span class="mf">0.0248149596</span><span class="p">,</span>
</span><span id="__span-51-22"><a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a> <span class="mf">0.0128901172</span><span class="p">,</span>
</span><span id="__span-51-23"><a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a> <span class="mf">0.0107588246</span><span class="p">,</span>
</span><span id="__span-51-24"><a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-51-25"><a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a> <span class="o">-</span><span class="mf">0.00180952181</span><span class="p">,</span>
</span><span id="__span-51-26"><a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a> <span class="o">-</span><span class="mf">0.0054573305</span><span class="p">,</span>
</span><span id="__span-51-27"><a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a> <span class="mf">0.0117037306</span><span class="p">,</span>
</span><span id="__span-51-28"><a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a> <span class="mf">0.0169312079</span>
</span><span id="__span-51-29"><a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a> <span class="p">]</span>
</span><span id="__span-51-30"><a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a> <span class="p">}</span>
</span><span id="__span-51-31"><a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a> <span class="p">],</span>
</span><span id="__span-51-32"><a id="__codelineno-51-32" name="__codelineno-51-32" href="#__codelineno-51-32"></a> <span class="s2">&quot;imageEmbedding&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-51-33"><a id="__codelineno-51-33" name="__codelineno-51-33" href="#__codelineno-51-33"></a> <span class="o">-</span><span class="mf">0.00728622358</span><span class="p">,</span>
</span><span id="__span-51-34"><a id="__codelineno-51-34" name="__codelineno-51-34" href="#__codelineno-51-34"></a> <span class="mf">0.031021487</span><span class="p">,</span>
</span><span id="__span-51-35"><a id="__codelineno-51-35" name="__codelineno-51-35" href="#__codelineno-51-35"></a> <span class="o">-</span><span class="mf">0.00206603738</span><span class="p">,</span>
</span><span id="__span-51-36"><a id="__codelineno-51-36" name="__codelineno-51-36" href="#__codelineno-51-36"></a> <span class="mf">0.0273937676</span><span class="p">,</span>
</span><span id="__span-51-37"><a id="__codelineno-51-37" name="__codelineno-51-37" href="#__codelineno-51-37"></a> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span><span id="__span-51-38"><a id="__codelineno-51-38" name="__codelineno-51-38" href="#__codelineno-51-38"></a> <span class="o">-</span><span class="mf">0.00204976718</span><span class="p">,</span>
</span><span id="__span-51-39"><a id="__codelineno-51-39" name="__codelineno-51-39" href="#__codelineno-51-39"></a> <span class="mf">0.00321615417</span><span class="p">,</span>
</span><span id="__span-51-40"><a id="__codelineno-51-40" name="__codelineno-51-40" href="#__codelineno-51-40"></a> <span class="mf">0.0121978866</span><span class="p">,</span>
</span><span id="__span-51-41"><a id="__codelineno-51-41" name="__codelineno-51-41" href="#__codelineno-51-41"></a> <span class="mf">0.0193375275</span>
</span><span id="__span-51-42"><a id="__codelineno-51-42" name="__codelineno-51-42" href="#__codelineno-51-42"></a> <span class="p">]</span>
</span><span id="__span-51-43"><a id="__codelineno-51-43" name="__codelineno-51-43" href="#__codelineno-51-43"></a> <span class="p">}</span>
</span><span id="__span-51-44"><a id="__codelineno-51-44" name="__codelineno-51-44" href="#__codelineno-51-44"></a> <span class="p">],</span>
</span><span id="__span-51-45"><a id="__codelineno-51-45" name="__codelineno-51-45" href="#__codelineno-51-45"></a> <span class="s2">&quot;deployedModelId&quot;</span><span class="p">:</span> <span class="s2">&quot;DEPLOYED_MODEL_ID&quot;</span>
</span><span id="__span-51-46"><a id="__codelineno-51-46" name="__codelineno-51-46" href="#__codelineno-51-46"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="vertex-ai-sdk-for-python_2">Vertex AI SDK for Python<a class="headerlink" href="#vertex-ai-sdk-for-python_2" title="Permanent link">&para;</a></h3>
<p>To learn how to install or update the Vertex AI SDK for Python, see <a href="https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk">Install the Vertex AI SDK for Python</a>.
For more information, see the
<a href="https://cloud.google.com/python/docs/reference/aiplatform/latest">Vertex AI SDK for Python API reference documentation</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">vertexai</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">vertexai.vision_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">MultiModalEmbeddingModel</span><span class="p">,</span> <span class="n">Video</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">vertexai.vision_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">VideoSegmentConfig</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="c1"># TODO(developer): Update &amp; uncomment line below</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="c1"># PROJECT_ID = &quot;your-project-id&quot;</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="n">vertexai</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;us-central1&quot;</span><span class="p">)</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MultiModalEmbeddingModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;multimodalembedding@001&quot;</span><span class="p">)</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai/llm/prompts/landmark1.png&quot;</span>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="p">)</span>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="n">video</span> <span class="o">=</span> <span class="n">Video</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a> <span class="s2">&quot;gs://cloud-samples-data/vertex-ai-vision/highway_vehicles.mp4&quot;</span>
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="p">)</span>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a>
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="n">embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">(</span>
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a> <span class="n">video</span><span class="o">=</span><span class="n">video</span><span class="p">,</span>
</span><span id="__span-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a> <span class="n">video_segment_config</span><span class="o">=</span><span class="n">VideoSegmentConfig</span><span class="p">(</span><span class="n">end_offset_sec</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span><span id="__span-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a> <span class="n">contextual_text</span><span class="o">=</span><span class="s2">&quot;Cars on Highway&quot;</span><span class="p">,</span>
</span><span id="__span-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a><span class="p">)</span>
</span><span id="__span-52-25"><a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a>
</span><span id="__span-52-26"><a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image Embedding: </span><span class="si">{</span><span class="n">embeddings</span><span class="o">.</span><span class="n">image_embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-52-27"><a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a>
</span><span id="__span-52-28"><a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a><span class="c1"># Video Embeddings are segmented based on the video_segment_config.</span>
</span><span id="__span-52-29"><a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video Embeddings:&quot;</span><span class="p">)</span>
</span><span id="__span-52-30"><a id="__codelineno-52-30" name="__codelineno-52-30" href="#__codelineno-52-30"></a><span class="k">for</span> <span class="n">video_embedding</span> <span class="ow">in</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">video_embeddings</span><span class="p">:</span>
</span><span id="__span-52-31"><a id="__codelineno-52-31" name="__codelineno-52-31" href="#__codelineno-52-31"></a> <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-52-32"><a id="__codelineno-52-32" name="__codelineno-52-32" href="#__codelineno-52-32"></a> <span class="sa">f</span><span class="s2">&quot;Video Segment: </span><span class="si">{</span><span class="n">video_embedding</span><span class="o">.</span><span class="n">start_offset_sec</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">video_embedding</span><span class="o">.</span><span class="n">end_offset_sec</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-52-33"><a id="__codelineno-52-33" name="__codelineno-52-33" href="#__codelineno-52-33"></a> <span class="p">)</span>
</span><span id="__span-52-34"><a id="__codelineno-52-34" name="__codelineno-52-34" href="#__codelineno-52-34"></a> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Embedding: </span><span class="si">{</span><span class="n">video_embedding</span><span class="o">.</span><span class="n">embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-52-35"><a id="__codelineno-52-35" name="__codelineno-52-35" href="#__codelineno-52-35"></a>
</span><span id="__span-52-36"><a id="__codelineno-52-36" name="__codelineno-52-36" href="#__codelineno-52-36"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Text Embedding: </span><span class="si">{</span><span class="n">embeddings</span><span class="o">.</span><span class="n">text_embedding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-52-37"><a id="__codelineno-52-37" name="__codelineno-52-37" href="#__codelineno-52-37"></a><span class="c1"># Example response:</span>
</span><span id="__span-52-38"><a id="__codelineno-52-38" name="__codelineno-52-38" href="#__codelineno-52-38"></a><span class="c1"># Image Embedding: [-0.0123144267, 0.0727186054, 0.000201397663, ...]</span>
</span><span id="__span-52-39"><a id="__codelineno-52-39" name="__codelineno-52-39" href="#__codelineno-52-39"></a><span class="c1"># Video Embeddings:</span>
</span><span id="__span-52-40"><a id="__codelineno-52-40" name="__codelineno-52-40" href="#__codelineno-52-40"></a><span class="c1"># Video Segment: 0.0 - 1.0</span>
</span><span id="__span-52-41"><a id="__codelineno-52-41" name="__codelineno-52-41" href="#__codelineno-52-41"></a><span class="c1"># Embedding: [-0.0206376351, 0.0345234685, ...]</span>
</span><span id="__span-52-42"><a id="__codelineno-52-42" name="__codelineno-52-42" href="#__codelineno-52-42"></a><span class="c1"># Text Embedding: [-0.0207006838, -0.00251058186, ...]</span>
</span></code></pre></div>
<h3 id="go_3">Go<a class="headerlink" href="#go_3" title="Permanent link">&para;</a></h3>
<p>Before trying this sample, follow the Go setup instructions in the
<a href="https://cloud.google.com/vertex-ai/docs/start/client-libraries">Vertex AI quickstart using
client libraries</a>.
For more information, see the
<a href="/go/docs/reference/cloud.google.com/go/aiplatform/latest/apiv1">Vertex AI Go API
reference documentation</a>.</p>
<p>To authenticate to Vertex AI, set up Application Default Credentials.
For more information, see
<a href="https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment">Set up authentication for a local development environment</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a> <span class="s2">&quot;context&quot;</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a> <span class="s2">&quot;encoding/json&quot;</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a> <span class="s2">&quot;fmt&quot;</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a> <span class="s2">&quot;io&quot;</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a> <span class="s2">&quot;time&quot;</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a> <span class="n">aiplatform</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1&quot;</span>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a> <span class="n">aiplatformpb</span> <span class="s2">&quot;cloud.google.com/go/aiplatform/apiv1beta1/aiplatformpb&quot;</span>
</span><span id="__span-53-10"><a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a> <span class="s2">&quot;google.golang.org/api/option&quot;</span>
</span><span id="__span-53-11"><a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a> <span class="s2">&quot;google.golang.org/protobuf/encoding/protojson&quot;</span>
</span><span id="__span-53-12"><a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a> <span class="s2">&quot;google.golang.org/protobuf/types/known/structpb&quot;</span>
</span><span id="__span-53-13"><a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a><span class="p">)</span>
</span><span id="__span-53-14"><a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a>
</span><span id="__span-53-15"><a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a><span class="o">//</span> <span class="n">generateForImageTextAndVideo</span> <span class="n">shows</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="n">multimodal</span> <span class="n">model</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">embeddings</span> <span class="k">for</span>
</span><span id="__span-53-16"><a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="o">//</span> <span class="n">image</span><span class="p">,</span> <span class="n">text</span> <span class="ow">and</span> <span class="n">video</span> <span class="n">data</span><span class="o">.</span>
</span><span id="__span-53-17"><a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="n">func</span> <span class="n">generateForImageTextAndVideo</span><span class="p">(</span><span class="n">w</span> <span class="n">io</span><span class="o">.</span><span class="n">Writer</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span> <span class="n">string</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
</span><span id="__span-53-18"><a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a> <span class="o">//</span> <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span>
</span><span id="__span-53-19"><a id="__codelineno-53-19" name="__codelineno-53-19" href="#__codelineno-53-19"></a>
</span><span id="__span-53-20"><a id="__codelineno-53-20" name="__codelineno-53-20" href="#__codelineno-53-20"></a> <span class="o">//</span> <span class="n">The</span> <span class="n">default</span> <span class="n">context</span> <span class="n">timeout</span> <span class="n">may</span> <span class="n">be</span> <span class="ow">not</span> <span class="n">enough</span> <span class="n">to</span> <span class="n">process</span> <span class="n">a</span> <span class="n">video</span> <span class="nb">input</span><span class="o">.</span>
</span><span id="__span-53-21"><a id="__codelineno-53-21" name="__codelineno-53-21" href="#__codelineno-53-21"></a> <span class="n">ctx</span><span class="p">,</span> <span class="n">cancel</span> <span class="o">:=</span> <span class="n">context</span><span class="o">.</span><span class="n">WithTimeout</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">(),</span> <span class="mi">15</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span>
</span><span id="__span-53-22"><a id="__codelineno-53-22" name="__codelineno-53-22" href="#__codelineno-53-22"></a> <span class="n">defer</span> <span class="n">cancel</span><span class="p">()</span>
</span><span id="__span-53-23"><a id="__codelineno-53-23" name="__codelineno-53-23" href="#__codelineno-53-23"></a>
</span><span id="__span-53-24"><a id="__codelineno-53-24" name="__codelineno-53-24" href="#__codelineno-53-24"></a> <span class="n">apiEndpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-aiplatform.googleapis.com:443&quot;</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
</span><span id="__span-53-25"><a id="__codelineno-53-25" name="__codelineno-53-25" href="#__codelineno-53-25"></a> <span class="n">client</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">aiplatform</span><span class="o">.</span><span class="n">NewPredictionClient</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">WithEndpoint</span><span class="p">(</span><span class="n">apiEndpoint</span><span class="p">))</span>
</span><span id="__span-53-26"><a id="__codelineno-53-26" name="__codelineno-53-26" href="#__codelineno-53-26"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-53-27"><a id="__codelineno-53-27" name="__codelineno-53-27" href="#__codelineno-53-27"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct API client: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-53-28"><a id="__codelineno-53-28" name="__codelineno-53-28" href="#__codelineno-53-28"></a> <span class="p">}</span>
</span><span id="__span-53-29"><a id="__codelineno-53-29" name="__codelineno-53-29" href="#__codelineno-53-29"></a> <span class="n">defer</span> <span class="n">client</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</span><span id="__span-53-30"><a id="__codelineno-53-30" name="__codelineno-53-30" href="#__codelineno-53-30"></a>
</span><span id="__span-53-31"><a id="__codelineno-53-31" name="__codelineno-53-31" href="#__codelineno-53-31"></a> <span class="n">model</span> <span class="o">:=</span> <span class="s2">&quot;multimodalembedding@001&quot;</span>
</span><span id="__span-53-32"><a id="__codelineno-53-32" name="__codelineno-53-32" href="#__codelineno-53-32"></a> <span class="n">endpoint</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">&quot;projects/</span><span class="si">%s</span><span class="s2">/locations/</span><span class="si">%s</span><span class="s2">/publishers/google/models/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="__span-53-33"><a id="__codelineno-53-33" name="__codelineno-53-33" href="#__codelineno-53-33"></a>
</span><span id="__span-53-34"><a id="__codelineno-53-34" name="__codelineno-53-34" href="#__codelineno-53-34"></a> <span class="o">//</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">to</span> <span class="n">the</span> <span class="n">model</span><span class="s1">&#39;s prediction call. For schema, see:</span>
</span><span id="__span-53-35"><a id="__codelineno-53-35" name="__codelineno-53-35" href="#__codelineno-53-35"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#request_body</span>
</span><span id="__span-53-36"><a id="__codelineno-53-36" name="__codelineno-53-36" href="#__codelineno-53-36"></a> <span class="n">instance</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">structpb</span><span class="o">.</span><span class="n">NewValue</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-53-37"><a id="__codelineno-53-37" name="__codelineno-53-37" href="#__codelineno-53-37"></a> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Domestic cats in natural conditions&quot;</span><span class="p">,</span>
</span><span id="__span-53-38"><a id="__codelineno-53-38" name="__codelineno-53-38" href="#__codelineno-53-38"></a> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-53-39"><a id="__codelineno-53-39" name="__codelineno-53-39" href="#__codelineno-53-39"></a> <span class="o">//</span> <span class="n">Image</span> <span class="ow">and</span> <span class="n">video</span> <span class="n">inputs</span> <span class="n">can</span> <span class="n">be</span> <span class="n">provided</span> <span class="n">either</span> <span class="k">as</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">Cloud</span> <span class="n">Storage</span> <span class="n">URI</span> <span class="ow">or</span> <span class="k">as</span>
</span><span id="__span-53-40"><a id="__codelineno-53-40" name="__codelineno-53-40" href="#__codelineno-53-40"></a> <span class="o">//</span> <span class="n">base64</span><span class="o">-</span><span class="n">encoded</span> <span class="nb">bytes</span> <span class="n">using</span> <span class="n">the</span> <span class="s2">&quot;bytesBase64Encoded&quot;</span> <span class="n">field</span><span class="o">.</span>
</span><span id="__span-53-41"><a id="__codelineno-53-41" name="__codelineno-53-41" href="#__codelineno-53-41"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;gs://cloud-samples-data/generative-ai/image/320px-Felis_catus-cat_on_snow.jpg&quot;</span><span class="p">,</span>
</span><span id="__span-53-42"><a id="__codelineno-53-42" name="__codelineno-53-42" href="#__codelineno-53-42"></a> <span class="p">},</span>
</span><span id="__span-53-43"><a id="__codelineno-53-43" name="__codelineno-53-43" href="#__codelineno-53-43"></a> <span class="s2">&quot;video&quot;</span><span class="p">:</span> <span class="nb">map</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nb">any</span><span class="p">{</span>
</span><span id="__span-53-44"><a id="__codelineno-53-44" name="__codelineno-53-44" href="#__codelineno-53-44"></a> <span class="s2">&quot;gcsUri&quot;</span><span class="p">:</span> <span class="s2">&quot;gs://cloud-samples-data/video/cat.mp4&quot;</span><span class="p">,</span>
</span><span id="__span-53-45"><a id="__codelineno-53-45" name="__codelineno-53-45" href="#__codelineno-53-45"></a> <span class="p">},</span>
</span><span id="__span-53-46"><a id="__codelineno-53-46" name="__codelineno-53-46" href="#__codelineno-53-46"></a> <span class="p">})</span>
</span><span id="__span-53-47"><a id="__codelineno-53-47" name="__codelineno-53-47" href="#__codelineno-53-47"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-53-48"><a id="__codelineno-53-48" name="__codelineno-53-48" href="#__codelineno-53-48"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to construct request payload: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-53-49"><a id="__codelineno-53-49" name="__codelineno-53-49" href="#__codelineno-53-49"></a> <span class="p">}</span>
</span><span id="__span-53-50"><a id="__codelineno-53-50" name="__codelineno-53-50" href="#__codelineno-53-50"></a>
</span><span id="__span-53-51"><a id="__codelineno-53-51" name="__codelineno-53-51" href="#__codelineno-53-51"></a> <span class="n">req</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">aiplatformpb</span><span class="o">.</span><span class="n">PredictRequest</span><span class="p">{</span>
</span><span id="__span-53-52"><a id="__codelineno-53-52" name="__codelineno-53-52" href="#__codelineno-53-52"></a> <span class="n">Endpoint</span><span class="p">:</span> <span class="n">endpoint</span><span class="p">,</span>
</span><span id="__span-53-53"><a id="__codelineno-53-53" name="__codelineno-53-53" href="#__codelineno-53-53"></a> <span class="o">//</span> <span class="n">The</span> <span class="n">model</span> <span class="n">supports</span> <span class="n">only</span> <span class="mi">1</span> <span class="n">instance</span> <span class="n">per</span> <span class="n">request</span><span class="o">.</span>
</span><span id="__span-53-54"><a id="__codelineno-53-54" name="__codelineno-53-54" href="#__codelineno-53-54"></a> <span class="n">Instances</span><span class="p">:</span> <span class="p">[]</span><span class="o">*</span><span class="n">structpb</span><span class="o">.</span><span class="n">Value</span><span class="p">{</span><span class="n">instance</span><span class="p">},</span>
</span><span id="__span-53-55"><a id="__codelineno-53-55" name="__codelineno-53-55" href="#__codelineno-53-55"></a> <span class="p">}</span>
</span><span id="__span-53-56"><a id="__codelineno-53-56" name="__codelineno-53-56" href="#__codelineno-53-56"></a>
</span><span id="__span-53-57"><a id="__codelineno-53-57" name="__codelineno-53-57" href="#__codelineno-53-57"></a> <span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span>
</span><span id="__span-53-58"><a id="__codelineno-53-58" name="__codelineno-53-58" href="#__codelineno-53-58"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-53-59"><a id="__codelineno-53-59" name="__codelineno-53-59" href="#__codelineno-53-59"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to generate embeddings: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-53-60"><a id="__codelineno-53-60" name="__codelineno-53-60" href="#__codelineno-53-60"></a> <span class="p">}</span>
</span><span id="__span-53-61"><a id="__codelineno-53-61" name="__codelineno-53-61" href="#__codelineno-53-61"></a>
</span><span id="__span-53-62"><a id="__codelineno-53-62" name="__codelineno-53-62" href="#__codelineno-53-62"></a> <span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">protojson</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">GetPredictions</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-53-63"><a id="__codelineno-53-63" name="__codelineno-53-63" href="#__codelineno-53-63"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-53-64"><a id="__codelineno-53-64" name="__codelineno-53-64" href="#__codelineno-53-64"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to convert protobuf value to JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-53-65"><a id="__codelineno-53-65" name="__codelineno-53-65" href="#__codelineno-53-65"></a> <span class="p">}</span>
</span><span id="__span-53-66"><a id="__codelineno-53-66" name="__codelineno-53-66" href="#__codelineno-53-66"></a> <span class="o">//</span> <span class="n">For</span> <span class="n">response</span> <span class="n">schema</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span>
</span><span id="__span-53-67"><a id="__codelineno-53-67" name="__codelineno-53-67" href="#__codelineno-53-67"></a> <span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vertex</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">generative</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">reference</span><span class="o">/</span><span class="n">multimodal</span><span class="o">-</span><span class="n">embeddings</span><span class="o">-</span><span class="n">api</span><span class="c1">#response-body</span>
</span><span id="__span-53-68"><a id="__codelineno-53-68" name="__codelineno-53-68" href="#__codelineno-53-68"></a> <span class="n">var</span> <span class="n">instanceEmbeddings</span> <span class="n">struct</span> <span class="p">{</span>
</span><span id="__span-53-69"><a id="__codelineno-53-69" name="__codelineno-53-69" href="#__codelineno-53-69"></a> <span class="n">ImageEmbeddings</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;imageEmbedding&quot;</span><span class="err">`</span>
</span><span id="__span-53-70"><a id="__codelineno-53-70" name="__codelineno-53-70" href="#__codelineno-53-70"></a> <span class="n">TextEmbeddings</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;textEmbedding&quot;</span><span class="err">`</span>
</span><span id="__span-53-71"><a id="__codelineno-53-71" name="__codelineno-53-71" href="#__codelineno-53-71"></a> <span class="n">VideoEmbeddings</span> <span class="p">[]</span><span class="n">struct</span> <span class="p">{</span>
</span><span id="__span-53-72"><a id="__codelineno-53-72" name="__codelineno-53-72" href="#__codelineno-53-72"></a> <span class="n">Embedding</span> <span class="p">[]</span><span class="n">float32</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;embedding&quot;</span><span class="err">`</span>
</span><span id="__span-53-73"><a id="__codelineno-53-73" name="__codelineno-53-73" href="#__codelineno-53-73"></a> <span class="n">StartOffsetSec</span> <span class="n">float64</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;startOffsetSec&quot;</span><span class="err">`</span>
</span><span id="__span-53-74"><a id="__codelineno-53-74" name="__codelineno-53-74" href="#__codelineno-53-74"></a> <span class="n">EndOffsetSec</span> <span class="n">float64</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;endOffsetSec&quot;</span><span class="err">`</span>
</span><span id="__span-53-75"><a id="__codelineno-53-75" name="__codelineno-53-75" href="#__codelineno-53-75"></a> <span class="p">}</span> <span class="err">`</span><span class="n">json</span><span class="p">:</span><span class="s2">&quot;videoEmbeddings&quot;</span><span class="err">`</span>
</span><span id="__span-53-76"><a id="__codelineno-53-76" name="__codelineno-53-76" href="#__codelineno-53-76"></a> <span class="p">}</span>
</span><span id="__span-53-77"><a id="__codelineno-53-77" name="__codelineno-53-77" href="#__codelineno-53-77"></a> <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">instanceEmbeddingsJson</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">instanceEmbeddings</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
</span><span id="__span-53-78"><a id="__codelineno-53-78" name="__codelineno-53-78" href="#__codelineno-53-78"></a> <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s2">&quot;failed to unmarshal JSON: %w&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-53-79"><a id="__codelineno-53-79" name="__codelineno-53-79" href="#__codelineno-53-79"></a> <span class="p">}</span>
</span><span id="__span-53-80"><a id="__codelineno-53-80" name="__codelineno-53-80" href="#__codelineno-53-80"></a>
</span><span id="__span-53-81"><a id="__codelineno-53-81" name="__codelineno-53-81" href="#__codelineno-53-81"></a> <span class="n">imageEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">ImageEmbeddings</span>
</span><span id="__span-53-82"><a id="__codelineno-53-82" name="__codelineno-53-82" href="#__codelineno-53-82"></a> <span class="n">textEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">TextEmbeddings</span>
</span><span id="__span-53-83"><a id="__codelineno-53-83" name="__codelineno-53-83" href="#__codelineno-53-83"></a> <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">embedding</span> <span class="k">for</span> <span class="n">our</span> <span class="n">single</span> <span class="n">video</span> <span class="n">segment</span> <span class="p">(</span><span class="err">`</span><span class="o">.</span><span class="n">videoEmbeddings</span><span class="err">`</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">one</span> <span class="n">entry</span> <span class="n">per</span>
</span><span id="__span-53-84"><a id="__codelineno-53-84" name="__codelineno-53-84" href="#__codelineno-53-84"></a> <span class="o">//</span> <span class="n">each</span> <span class="n">processed</span> <span class="n">segment</span><span class="p">)</span><span class="o">.</span>
</span><span id="__span-53-85"><a id="__codelineno-53-85" name="__codelineno-53-85" href="#__codelineno-53-85"></a> <span class="n">videoEmbedding</span> <span class="o">:=</span> <span class="n">instanceEmbeddings</span><span class="o">.</span><span class="n">VideoEmbeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Embedding</span>
</span><span id="__span-53-86"><a id="__codelineno-53-86" name="__codelineno-53-86" href="#__codelineno-53-86"></a>
</span><span id="__span-53-87"><a id="__codelineno-53-87" name="__codelineno-53-87" href="#__codelineno-53-87"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Image embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">imageEmbedding</span><span class="p">),</span> <span class="n">imageEmbedding</span><span class="p">)</span>
</span><span id="__span-53-88"><a id="__codelineno-53-88" name="__codelineno-53-88" href="#__codelineno-53-88"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Text embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">textEmbedding</span><span class="p">),</span> <span class="n">textEmbedding</span><span class="p">)</span>
</span><span id="__span-53-89"><a id="__codelineno-53-89" name="__codelineno-53-89" href="#__codelineno-53-89"></a> <span class="n">fmt</span><span class="o">.</span><span class="n">Fprintf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;Video embedding (length=</span><span class="si">%d</span><span class="s2">): %v</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">videoEmbedding</span><span class="p">),</span> <span class="n">videoEmbedding</span><span class="p">)</span>
</span><span id="__span-53-90"><a id="__codelineno-53-90" name="__codelineno-53-90" href="#__codelineno-53-90"></a> <span class="o">//</span> <span class="n">Example</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-53-91"><a id="__codelineno-53-91" name="__codelineno-53-91" href="#__codelineno-53-91"></a> <span class="o">//</span> <span class="n">Image</span> <span class="n">embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1408</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01558477</span> <span class="mf">0.0258355</span> <span class="mf">0.016342038</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-53-92"><a id="__codelineno-53-92" name="__codelineno-53-92" href="#__codelineno-53-92"></a> <span class="o">//</span> <span class="n">Text</span> <span class="n">embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1408</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.005894961</span> <span class="mf">0.008349559</span> <span class="mf">0.015355394</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-53-93"><a id="__codelineno-53-93" name="__codelineno-53-93" href="#__codelineno-53-93"></a> <span class="o">//</span> <span class="n">Video</span> <span class="n">embedding</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1408</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.018867437</span> <span class="mf">0.013997682</span> <span class="mf">0.0012682161</span> <span class="o">...</span> <span class="p">]</span>
</span><span id="__span-53-94"><a id="__codelineno-53-94" name="__codelineno-53-94" href="#__codelineno-53-94"></a>
</span><span id="__span-53-95"><a id="__codelineno-53-95" name="__codelineno-53-95" href="#__codelineno-53-95"></a> <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-53-96"><a id="__codelineno-53-96" name="__codelineno-53-96" href="#__codelineno-53-96"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="whats-next">What's next<a class="headerlink" href="#whats-next" title="Permanent link">&para;</a></h2>
<ul>
<li>Read the blog <a href="https://cloud.google.com/blog/products/ai-machine-learning/multimodal-generative-ai-search">"What is Multimodal Search: 'LLMs with vision' change
 businesses"</a>.</li>
<li>For information about text-only use cases (text-based semantic search,
 clustering, long-form document analysis, and other text retrieval or
 question-answering use cases), read
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/embeddings/get-text-embeddings">Get text embeddings</a>.</li>
<li>View all Vertex AI image generative AI offerings in the <a href="../../image/Imagen-on-Vertex-AI/">Imagen on Vertex AI overview</a>.</li>
<li>Explore more pretrained models in
 <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/model-garden/explore-models">Model Garden</a>.</li>
<li>Learn about <a href="https://cloud.google.com/vertex-ai/generative-ai/docs/learn/responsible-ai">responsible AI best practices and safety filters in
 Vertex AI</a>.</li>
</ul>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Get-batch-text-embeddings-predictions/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Get Text Embeddings">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Get Text Embeddings
              </div>
            </div>
          </a>
        
        
          
          <a href="../../model-reference/Function-calling-reference/" class="md-footer__link md-footer__link--next" aria-label="Next: Use Function Calling">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Use Function Calling
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.path", "navigation.top", "navigation.tracking", "toc.follow", "navigation.tabs", "navigation.sections", "navigation.tracking", "navigation.top", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../js/chat-widget/gemini-client.js"></script>
      
        <script src="../../js/chat-widget/init.js"></script>
      
        <script src="../../js/chat-widget/setup-key.js"></script>
      
        <script src="../../js/chat-widget-helper.js"></script>
      
    
  </body>
</html>